import{_ as n}from"./plugin-vue_export-helper.21dcd24c.js";import{o as s,c as a,e}from"./app.09d9ce72.js";const t={},p=e(`<p><img src="http://img.dabin-coder.cn/image/\u5E76\u53D1\u4E0E\u591A\u7EBF\u7A0B\u77E5\u8BC6\u70B9\u603B\u7ED3.jpg" alt="" loading="lazy"></p><h2 id="\u7EBF\u7A0B\u6C60" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u7A0B\u6C60" aria-hidden="true">#</a> \u7EBF\u7A0B\u6C60</h2><p>\u7EBF\u7A0B\u6C60\uFF1A\u4E00\u4E2A\u7BA1\u7406\u7EBF\u7A0B\u7684\u6C60\u5B50\u3002</p><h3 id="\u4E3A\u4EC0\u4E48\u5E73\u65F6\u90FD\u662F\u4F7F\u7528\u7EBF\u7A0B\u6C60\u521B\u5EFA\u7EBF\u7A0B-\u76F4\u63A5new\u4E00\u4E2A\u7EBF\u7A0B\u4E0D\u597D\u5417" tabindex="-1"><a class="header-anchor" href="#\u4E3A\u4EC0\u4E48\u5E73\u65F6\u90FD\u662F\u4F7F\u7528\u7EBF\u7A0B\u6C60\u521B\u5EFA\u7EBF\u7A0B-\u76F4\u63A5new\u4E00\u4E2A\u7EBF\u7A0B\u4E0D\u597D\u5417" aria-hidden="true">#</a> \u4E3A\u4EC0\u4E48\u5E73\u65F6\u90FD\u662F\u4F7F\u7528\u7EBF\u7A0B\u6C60\u521B\u5EFA\u7EBF\u7A0B\uFF0C\u76F4\u63A5new\u4E00\u4E2A\u7EBF\u7A0B\u4E0D\u597D\u5417\uFF1F</h3><p>\u55EF\uFF0C\u624B\u52A8\u521B\u5EFA\u7EBF\u7A0B\u6709\u4E24\u4E2A\u7F3A\u70B9</p><ol><li>\u4E0D\u53D7\u63A7\u98CE\u9669</li><li>\u9891\u7E41\u521B\u5EFA\u5F00\u9500\u5927</li></ol><p><strong>\u4E3A\u4EC0\u4E48\u4E0D\u53D7\u63A7</strong>\uFF1F</p><p>\u7CFB\u7EDF\u8D44\u6E90\u6709\u9650\uFF0C\u6BCF\u4E2A\u4EBA\u9488\u5BF9\u4E0D\u540C\u4E1A\u52A1\u90FD\u53EF\u4EE5\u624B\u52A8\u521B\u5EFA\u7EBF\u7A0B\uFF0C\u5E76\u4E14\u521B\u5EFA\u7EBF\u7A0B\u6CA1\u6709\u7EDF\u4E00\u6807\u51C6\uFF0C\u6BD4\u5982\u521B\u5EFA\u7684\u7EBF\u7A0B\u6709\u6CA1\u6709\u540D\u5B57\u7B49\u3002\u5F53\u7CFB\u7EDF\u8FD0\u884C\u8D77\u6765\uFF0C\u6240\u6709\u7EBF\u7A0B\u90FD\u5728\u62A2\u5360\u8D44\u6E90\uFF0C\u6BEB\u65E0\u89C4\u5219\uFF0C\u6DF7\u4E71\u573A\u9762\u53EF\u60F3\u800C\u77E5\uFF0C\u4E0D\u597D\u7BA1\u63A7\u3002</p><p><strong>\u9891\u7E41\u624B\u52A8\u521B\u5EFA\u7EBF\u7A0B\u4E3A\u4EC0\u4E48\u5F00\u9500\u4F1A\u5927\uFF1F\u8DDFnew Object() \u6709\u4EC0\u4E48\u5DEE\u522B\uFF1F</strong></p><p>\u867D\u7136Java\u4E2D\u4E07\u7269\u7686\u5BF9\u8C61\uFF0C\u4F46\u662Fnew Thread() \u521B\u5EFA\u4E00\u4E2A\u7EBF\u7A0B\u548C new Object()\u8FD8\u662F\u6709\u533A\u522B\u7684\u3002</p><p>new Object()\u8FC7\u7A0B\u5982\u4E0B\uFF1A</p><ol><li>JVM\u5206\u914D\u4E00\u5757\u5185\u5B58 M</li><li>\u5728\u5185\u5B58 M \u4E0A\u521D\u59CB\u5316\u8BE5\u5BF9\u8C61</li><li>\u5C06\u5185\u5B58 M \u7684\u5730\u5740\u8D4B\u503C\u7ED9\u5F15\u7528\u53D8\u91CF obj</li></ol><p>\u521B\u5EFA\u7EBF\u7A0B\u7684\u8FC7\u7A0B\u5982\u4E0B\uFF1A</p><ol><li>JVM\u4E3A\u4E00\u4E2A\u7EBF\u7A0B\u6808\u5206\u914D\u5185\u5B58\uFF0C\u8BE5\u6808\u4E3A\u6BCF\u4E2A\u7EBF\u7A0B\u65B9\u6CD5\u8C03\u7528\u4FDD\u5B58\u4E00\u4E2A\u6808\u5E27</li><li>\u6BCF\u4E00\u6808\u5E27\u7531\u4E00\u4E2A\u5C40\u90E8\u53D8\u91CF\u6570\u7EC4\u3001\u8FD4\u56DE\u503C\u3001\u64CD\u4F5C\u6570\u5806\u6808\u548C\u5E38\u91CF\u6C60\u7EC4\u6210</li><li>\u6BCF\u4E2A\u7EBF\u7A0B\u83B7\u5F97\u4E00\u4E2A\u7A0B\u5E8F\u8BA1\u6570\u5668\uFF0C\u7528\u4E8E\u8BB0\u5F55\u5F53\u524D\u865A\u62DF\u673A\u6B63\u5728\u6267\u884C\u7684\u7EBF\u7A0B\u6307\u4EE4\u5730\u5740</li><li>\u7CFB\u7EDF\u521B\u5EFA\u4E00\u4E2A\u4E0EJava\u7EBF\u7A0B\u5BF9\u5E94\u7684\u672C\u673A\u7EBF\u7A0B</li><li>\u5C06\u4E0E\u7EBF\u7A0B\u76F8\u5173\u7684\u63CF\u8FF0\u7B26\u6DFB\u52A0\u5230JVM\u5185\u90E8\u6570\u636E\u7ED3\u6784\u4E2D</li><li>\u7EBF\u7A0B\u5171\u4EAB\u5806\u548C\u65B9\u6CD5\u533A\u57DF</li></ol><p>\u521B\u5EFA\u4E00\u4E2A\u7EBF\u7A0B\u5927\u6982\u9700\u89811M\u5DE6\u53F3\u7684\u7A7A\u95F4\uFF08Java8\uFF0C\u673A\u5668\u89C4\u683C2c8G\uFF09\u3002\u53EF\u89C1\uFF0C\u9891\u7E41\u624B\u52A8\u521B\u5EFA/\u9500\u6BC1\u7EBF\u7A0B\u7684\u4EE3\u4EF7\u662F\u975E\u5E38\u5927\u7684\u3002</p><h3 id="\u4E3A\u4EC0\u4E48\u4F7F\u7528\u7EBF\u7A0B\u6C60" tabindex="-1"><a class="header-anchor" href="#\u4E3A\u4EC0\u4E48\u4F7F\u7528\u7EBF\u7A0B\u6C60" aria-hidden="true">#</a> \u4E3A\u4EC0\u4E48\u4F7F\u7528\u7EBF\u7A0B\u6C60\uFF1F</h3><ul><li><strong>\u964D\u4F4E\u8D44\u6E90\u6D88\u8017</strong>\u3002\u901A\u8FC7\u91CD\u590D\u5229\u7528\u5DF2\u521B\u5EFA\u7684\u7EBF\u7A0B\u964D\u4F4E\u7EBF\u7A0B\u521B\u5EFA\u548C\u9500\u6BC1\u9020\u6210\u7684\u6D88\u8017\u3002</li><li><strong>\u63D0\u9AD8\u54CD\u5E94\u901F\u5EA6</strong>\u3002\u5F53\u4EFB\u52A1\u5230\u8FBE\u65F6\uFF0C\u53EF\u4EE5\u4E0D\u9700\u8981\u7B49\u5230\u7EBF\u7A0B\u521B\u5EFA\u5C31\u80FD\u7ACB\u5373\u6267\u884C\u3002</li><li><strong>\u63D0\u9AD8\u7EBF\u7A0B\u7684\u53EF\u7BA1\u7406\u6027</strong>\u3002\u7EDF\u4E00\u7BA1\u7406\u7EBF\u7A0B\uFF0C\u907F\u514D\u7CFB\u7EDF\u521B\u5EFA\u5927\u91CF\u540C\u7C7B\u7EBF\u7A0B\u800C\u5BFC\u81F4\u6D88\u8017\u5B8C\u5185\u5B58\u3002</li></ul><h3 id="\u7EBF\u7A0B\u6C60\u6267\u884C\u539F\u7406" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u7A0B\u6C60\u6267\u884C\u539F\u7406" aria-hidden="true">#</a> \u7EBF\u7A0B\u6C60\u6267\u884C\u539F\u7406\uFF1F</h3><p><img src="http://img.dabin-coder.cn/image/\u7EBF\u7A0B\u6C60\u6267\u884C\u6D41\u7A0B.png" alt="\u7EBF\u7A0B\u6C60\u6267\u884C\u6D41\u7A0B" loading="lazy"></p><ol><li>\u5F53\u7EBF\u7A0B\u6C60\u91CC\u5B58\u6D3B\u7684\u7EBF\u7A0B\u6570\u5C0F\u4E8E\u6838\u5FC3\u7EBF\u7A0B\u6570<code>corePoolSize</code>\u65F6\uFF0C\u8FD9\u65F6\u5BF9\u4E8E\u4E00\u4E2A\u65B0\u63D0\u4EA4\u7684\u4EFB\u52A1\uFF0C\u7EBF\u7A0B\u6C60\u4F1A\u521B\u5EFA\u4E00\u4E2A\u7EBF\u7A0B\u53BB\u5904\u7406\u4EFB\u52A1\u3002\u5F53\u7EBF\u7A0B\u6C60\u91CC\u9762\u5B58\u6D3B\u7684\u7EBF\u7A0B\u6570\u5C0F\u4E8E\u7B49\u4E8E\u6838\u5FC3\u7EBF\u7A0B\u6570<code>corePoolSize</code>\u65F6\uFF0C\u7EBF\u7A0B\u6C60\u91CC\u9762\u7684\u7EBF\u7A0B\u4F1A\u4E00\u76F4\u5B58\u6D3B\u7740\uFF0C\u5C31\u7B97\u7A7A\u95F2\u65F6\u95F4\u8D85\u8FC7\u4E86<code>keepAliveTime</code>\uFF0C\u7EBF\u7A0B\u4E5F\u4E0D\u4F1A\u88AB\u9500\u6BC1\uFF0C\u800C\u662F\u4E00\u76F4\u963B\u585E\u5728\u90A3\u91CC\u4E00\u76F4\u7B49\u5F85\u4EFB\u52A1\u961F\u5217\u7684\u4EFB\u52A1\u6765\u6267\u884C\u3002</li><li>\u5F53\u7EBF\u7A0B\u6C60\u91CC\u9762\u5B58\u6D3B\u7684\u7EBF\u7A0B\u6570\u5DF2\u7ECF\u7B49\u4E8EcorePoolSize\u4E86\uFF0C\u8FD9\u662F\u5BF9\u4E8E\u4E00\u4E2A\u65B0\u63D0\u4EA4\u7684\u4EFB\u52A1\uFF0C\u4F1A\u88AB\u653E\u8FDB\u4EFB\u52A1\u961F\u5217workQueue\u6392\u961F\u7B49\u5F85\u6267\u884C\u3002</li><li>\u5F53\u7EBF\u7A0B\u6C60\u91CC\u9762\u5B58\u6D3B\u7684\u7EBF\u7A0B\u6570\u5DF2\u7ECF\u7B49\u4E8E<code>corePoolSize</code>\u4E86\uFF0C\u5E76\u4E14\u4EFB\u52A1\u961F\u5217\u4E5F\u6EE1\u4E86\uFF0C\u5047\u8BBE<code>maximumPoolSize&gt;corePoolSize</code>\uFF0C\u8FD9\u65F6\u5982\u679C\u518D\u6765\u65B0\u7684\u4EFB\u52A1\uFF0C\u7EBF\u7A0B\u6C60\u5C31\u4F1A\u7EE7\u7EED\u521B\u5EFA\u65B0\u7684\u7EBF\u7A0B\u6765\u5904\u7406\u65B0\u7684\u4EFB\u52A1\uFF0C\u77E5\u9053\u7EBF\u7A0B\u6570\u8FBE\u5230<code>maximumPoolSize</code>\uFF0C\u5C31\u4E0D\u4F1A\u518D\u521B\u5EFA\u4E86\u3002</li><li>\u5982\u679C\u5F53\u524D\u7684\u7EBF\u7A0B\u6570\u8FBE\u5230\u4E86<code>maximumPoolSize</code>\uFF0C\u5E76\u4E14\u4EFB\u52A1\u961F\u5217\u4E5F\u6EE1\u4E86\uFF0C\u5982\u679C\u8FD8\u6709\u65B0\u7684\u4EFB\u52A1\u8FC7\u6765\uFF0C\u90A3\u5C31\u76F4\u63A5\u91C7\u7528\u62D2\u7EDD\u7B56\u7565\u8FDB\u884C\u5904\u7406\u3002\u9ED8\u8BA4\u7684\u62D2\u7EDD\u7B56\u7565\u662F\u629B\u51FA\u4E00\u4E2ARejectedExecutionException\u5F02\u5E38\u3002</li></ol><h3 id="\u7EBF\u7A0B\u6C60\u53C2\u6570\u6709\u54EA\u4E9B" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u7A0B\u6C60\u53C2\u6570\u6709\u54EA\u4E9B" aria-hidden="true">#</a> \u7EBF\u7A0B\u6C60\u53C2\u6570\u6709\u54EA\u4E9B\uFF1F</h3><p>ThreadPoolExecutor \u7684\u901A\u7528\u6784\u9020\u51FD\u6570\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>public ThreadPoolExecutor(int corePoolSize, int maximumPoolSize, long keepAliveTime, TimeUnit unit, BlockingQueue&lt;Runnable&gt; workQueue, ThreadFactory threadFactory, RejectedExecutionHandler handler);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>1\u3001<code>corePoolSize</code>\uFF1A\u5F53\u6709\u65B0\u4EFB\u52A1\u65F6\uFF0C\u5982\u679C\u7EBF\u7A0B\u6C60\u4E2D\u7EBF\u7A0B\u6570\u6CA1\u6709\u8FBE\u5230\u7EBF\u7A0B\u6C60\u7684\u57FA\u672C\u5927\u5C0F\uFF0C\u5219\u4F1A\u521B\u5EFA\u65B0\u7684\u7EBF\u7A0B\u6267\u884C\u4EFB\u52A1\uFF0C\u5426\u5219\u5C06\u4EFB\u52A1\u653E\u5165\u963B\u585E\u961F\u5217\u3002\u5F53\u7EBF\u7A0B\u6C60\u4E2D\u5B58\u6D3B\u7684\u7EBF\u7A0B\u6570\u603B\u662F\u5927\u4E8E corePoolSize \u65F6\uFF0C\u5E94\u8BE5\u8003\u8651\u8C03\u5927 corePoolSize\u3002</p><p>2\u3001<code>maximumPoolSize</code>\uFF1A\u5F53\u963B\u585E\u961F\u5217\u586B\u6EE1\u65F6\uFF0C\u5982\u679C\u7EBF\u7A0B\u6C60\u4E2D\u7EBF\u7A0B\u6570\u6CA1\u6709\u8D85\u8FC7\u6700\u5927\u7EBF\u7A0B\u6570\uFF0C\u5219\u4F1A\u521B\u5EFA\u65B0\u7684\u7EBF\u7A0B\u8FD0\u884C\u4EFB\u52A1\u3002\u5426\u5219\u6839\u636E\u62D2\u7EDD\u7B56\u7565\u5904\u7406\u65B0\u4EFB\u52A1\u3002\u975E\u6838\u5FC3\u7EBF\u7A0B\u7C7B\u4F3C\u4E8E\u4E34\u65F6\u501F\u6765\u7684\u8D44\u6E90\uFF0C\u8FD9\u4E9B\u7EBF\u7A0B\u5728\u7A7A\u95F2\u65F6\u95F4\u8D85\u8FC7 keepAliveTime \u4E4B\u540E\uFF0C\u5C31\u5E94\u8BE5\u9000\u51FA\uFF0C\u907F\u514D\u8D44\u6E90\u6D6A\u8D39\u3002</p><p>3\u3001<code>BlockingQueue</code>\uFF1A\u5B58\u50A8\u7B49\u5F85\u8FD0\u884C\u7684\u4EFB\u52A1\u3002</p><p>4\u3001<code>keepAliveTime</code>\uFF1A<strong>\u975E\u6838\u5FC3\u7EBF\u7A0B</strong>\u7A7A\u95F2\u540E\uFF0C\u4FDD\u6301\u5B58\u6D3B\u7684\u65F6\u95F4\uFF0C\u6B64\u53C2\u6570\u53EA\u5BF9\u975E\u6838\u5FC3\u7EBF\u7A0B\u6709\u6548\u3002\u8BBE\u7F6E\u4E3A0\uFF0C\u8868\u793A\u591A\u4F59\u7684\u7A7A\u95F2\u7EBF\u7A0B\u4F1A\u88AB\u7ACB\u5373\u7EC8\u6B62\u3002</p><p>5\u3001<code>TimeUnit</code>\uFF1A\u65F6\u95F4\u5355\u4F4D</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>DAYS
<span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>HOURS
<span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>MINUTES
<span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS
<span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>MILLISECONDS
<span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>MICROSECONDS
<span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>NANOSECONDS
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>6\u3001<code>ThreadFactory</code>\uFF1A\u6BCF\u5F53\u7EBF\u7A0B\u6C60\u521B\u5EFA\u4E00\u4E2A\u65B0\u7684\u7EBF\u7A0B\u65F6\uFF0C\u90FD\u662F\u901A\u8FC7\u7EBF\u7A0B\u5DE5\u5382\u65B9\u6CD5\u6765\u5B8C\u6210\u7684\u3002\u5728 ThreadFactory \u4E2D\u53EA\u5B9A\u4E49\u4E86\u4E00\u4E2A\u65B9\u6CD5 newThread\uFF0C\u6BCF\u5F53\u7EBF\u7A0B\u6C60\u9700\u8981\u521B\u5EFA\u65B0\u7EBF\u7A0B\u5C31\u4F1A\u8C03\u7528\u5B83\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyThreadFactory</span> <span class="token keyword">implements</span> <span class="token class-name">ThreadFactory</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> poolName<span class="token punctuation">;</span>
    
    <span class="token keyword">public</span> <span class="token class-name">MyThreadFactory</span><span class="token punctuation">(</span><span class="token class-name">String</span> poolName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>poolName <span class="token operator">=</span> poolName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token class-name">Thread</span> <span class="token function">newThread</span><span class="token punctuation">(</span><span class="token class-name">Runnable</span> runnable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MyAppThread</span><span class="token punctuation">(</span>runnable<span class="token punctuation">,</span> poolName<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//\u5C06\u7EBF\u7A0B\u6C60\u540D\u5B57\u4F20\u9012\u7ED9\u6784\u9020\u51FD\u6570\uFF0C\u7528\u4E8E\u533A\u5206\u4E0D\u540C\u7EBF\u7A0B\u6C60\u7684\u7EBF\u7A0B</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>7\u3001<code>RejectedExecutionHandler</code>\uFF1A\u5F53\u961F\u5217\u548C\u7EBF\u7A0B\u6C60\u90FD\u6EE1\u4E86\u7684\u65F6\u5019\uFF0C\u6839\u636E\u62D2\u7EDD\u7B56\u7565\u5904\u7406\u65B0\u4EFB\u52A1\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">AbortPolicy</span>\uFF1A\u9ED8\u8BA4\u7684\u7B56\u7565\uFF0C\u76F4\u63A5\u629B\u51FA<span class="token class-name">RejectedExecutionException</span>
<span class="token class-name">DiscardPolicy</span>\uFF1A\u4E0D\u5904\u7406\uFF0C\u76F4\u63A5\u4E22\u5F03
<span class="token class-name">DiscardOldestPolicy</span>\uFF1A\u5C06\u7B49\u5F85\u961F\u5217\u961F\u9996\u7684\u4EFB\u52A1\u4E22\u5F03\uFF0C\u5E76\u6267\u884C\u5F53\u524D\u4EFB\u52A1
<span class="token class-name">CallerRunsPolicy</span>\uFF1A\u7531\u8C03\u7528\u7EBF\u7A0B\u5904\u7406\u8BE5\u4EFB\u52A1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u7EBF\u7A0B\u6C60\u5927\u5C0F\u600E\u4E48\u8BBE\u7F6E" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u7A0B\u6C60\u5927\u5C0F\u600E\u4E48\u8BBE\u7F6E" aria-hidden="true">#</a> \u7EBF\u7A0B\u6C60\u5927\u5C0F\u600E\u4E48\u8BBE\u7F6E\uFF1F</h3><p>\u5982\u679C\u7EBF\u7A0B\u6C60\u7EBF\u7A0B\u6570\u91CF\u592A\u5C0F\uFF0C\u5F53\u6709\u5927\u91CF\u8BF7\u6C42\u9700\u8981\u5904\u7406\uFF0C\u7CFB\u7EDF\u54CD\u5E94\u6BD4\u8F83\u6162\uFF0C\u4F1A\u5F71\u54CD\u7528\u6237\u4F53\u9A8C\uFF0C\u751A\u81F3\u4F1A\u51FA\u73B0\u4EFB\u52A1\u961F\u5217\u5927\u91CF\u5806\u79EF\u4EFB\u52A1\u5BFC\u81F4OOM\u3002</p><p>\u5982\u679C\u7EBF\u7A0B\u6C60\u7EBF\u7A0B\u6570\u91CF\u8FC7\u5927\uFF0C\u5927\u91CF\u7EBF\u7A0B\u53EF\u80FD\u4F1A\u540C\u65F6\u62A2\u5360 CPU \u8D44\u6E90\uFF0C\u8FD9\u6837\u4F1A\u5BFC\u81F4\u5927\u91CF\u7684\u4E0A\u4E0B\u6587\u5207\u6362\uFF0C\u4ECE\u800C\u589E\u52A0\u7EBF\u7A0B\u7684\u6267\u884C\u65F6\u95F4\uFF0C\u5F71\u54CD\u4E86\u6267\u884C\u6548\u7387\u3002</p><p><strong>CPU \u5BC6\u96C6\u578B\u4EFB\u52A1(N+1)</strong>\uFF1A \u8FD9\u79CD\u4EFB\u52A1\u6D88\u8017\u7684\u4E3B\u8981\u662F CPU \u8D44\u6E90\uFF0C\u53EF\u4EE5\u5C06\u7EBF\u7A0B\u6570\u8BBE\u7F6E\u4E3A<code> N\uFF08CPU \u6838\u5FC3\u6570\uFF09+1</code>\uFF0C\u591A\u51FA\u6765\u7684\u4E00\u4E2A\u7EBF\u7A0B\u662F\u4E3A\u4E86\u9632\u6B62\u67D0\u4E9B\u539F\u56E0\u5BFC\u81F4\u7684\u7EBF\u7A0B\u963B\u585E\uFF08\u5982IO\u64CD\u4F5C\uFF0C\u7EBF\u7A0Bsleep\uFF0C\u7B49\u5F85\u9501\uFF09\u800C\u5E26\u6765\u7684\u5F71\u54CD\u3002\u4E00\u65E6\u67D0\u4E2A\u7EBF\u7A0B\u88AB\u963B\u585E\uFF0C\u91CA\u653E\u4E86CPU\u8D44\u6E90\uFF0C\u800C\u5728\u8FD9\u79CD\u60C5\u51B5\u4E0B\u591A\u51FA\u6765\u7684\u4E00\u4E2A\u7EBF\u7A0B\u5C31\u53EF\u4EE5\u5145\u5206\u5229\u7528 CPU \u7684\u7A7A\u95F2\u65F6\u95F4\u3002</p><p><strong>I/O \u5BC6\u96C6\u578B\u4EFB\u52A1(2N)</strong>\uFF1A \u7CFB\u7EDF\u7684\u5927\u90E8\u5206\u65F6\u95F4\u90FD\u5728\u5904\u7406 IO \u64CD\u4F5C\uFF0C\u6B64\u65F6\u7EBF\u7A0B\u53EF\u80FD\u4F1A\u88AB\u963B\u585E\uFF0C\u91CA\u653ECPU\u8D44\u6E90\uFF0C\u8FD9\u65F6\u5C31\u53EF\u4EE5\u5C06 CPU \u4EA4\u51FA\u7ED9\u5176\u5B83\u7EBF\u7A0B\u4F7F\u7528\u3002\u56E0\u6B64\u5728 IO \u5BC6\u96C6\u578B\u4EFB\u52A1\u7684\u5E94\u7528\u4E2D\uFF0C\u53EF\u4EE5\u591A\u914D\u7F6E\u4E00\u4E9B\u7EBF\u7A0B\uFF0C\u5177\u4F53\u7684\u8BA1\u7B97\u65B9\u6CD5\uFF1A<code>\u6700\u4F73\u7EBF\u7A0B\u6570 = CPU\u6838\u5FC3\u6570 * (1/CPU\u5229\u7528\u7387) = CPU\u6838\u5FC3\u6570 * (1 + (IO\u8017\u65F6/CPU\u8017\u65F6))</code>\uFF0C\u4E00\u822C\u53EF\u8BBE\u7F6E\u4E3A2N\u3002</p><h3 id="\u7EBF\u7A0B\u6C60\u7684\u7C7B\u578B\u6709\u54EA\u4E9B-\u9002\u7528\u573A\u666F" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u7A0B\u6C60\u7684\u7C7B\u578B\u6709\u54EA\u4E9B-\u9002\u7528\u573A\u666F" aria-hidden="true">#</a> \u7EBF\u7A0B\u6C60\u7684\u7C7B\u578B\u6709\u54EA\u4E9B\uFF1F\u9002\u7528\u573A\u666F\uFF1F</h3><p>\u5E38\u89C1\u7684\u7EBF\u7A0B\u6C60\u6709 <code>FixedThreadPool</code>\u3001<code>SingleThreadExecutor</code>\u3001<code>CachedThreadPool</code> \u548C <code>ScheduledThreadPool</code>\u3002\u8FD9\u51E0\u4E2A\u90FD\u662F <code>ExecutorService</code> \u7EBF\u7A0B\u6C60\u5B9E\u4F8B\u3002</p><p><strong>FixedThreadPool</strong></p><p>\u56FA\u5B9A\u7EBF\u7A0B\u6570\u7684\u7EBF\u7A0B\u6C60\u3002\u4EFB\u4F55\u65F6\u95F4\u70B9\uFF0C\u6700\u591A\u53EA\u6709 nThreads \u4E2A\u7EBF\u7A0B\u5904\u4E8E\u6D3B\u52A8\u72B6\u6001\u6267\u884C\u4EFB\u52A1\u3002</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>public static ExecutorService newFixedThreadPool(int nThreads) {
	return new ThreadPoolExecutor(nThreads, nThreads, 0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;Runnable&gt;());
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4F7F\u7528\u65E0\u754C\u961F\u5217 LinkedBlockingQueue\uFF08\u961F\u5217\u5BB9\u91CF\u4E3A Integer.MAX_VALUE\uFF09\uFF0C\u8FD0\u884C\u4E2D\u7684\u7EBF\u7A0B\u6C60\u4E0D\u4F1A\u62D2\u7EDD\u4EFB\u52A1\uFF0C\u5373\u4E0D\u4F1A\u8C03\u7528RejectedExecutionHandler.rejectedExecution()\u65B9\u6CD5\u3002</p><p>maxThreadPoolSize \u662F\u65E0\u6548\u53C2\u6570\uFF0C\u6545\u5C06\u5B83\u7684\u503C\u8BBE\u7F6E\u4E3A\u4E0E coreThreadPoolSize \u4E00\u81F4\u3002</p><p>keepAliveTime \u4E5F\u662F\u65E0\u6548\u53C2\u6570\uFF0C\u8BBE\u7F6E\u4E3A0L\uFF0C\u56E0\u4E3A\u6B64\u7EBF\u7A0B\u6C60\u91CC\u6240\u6709\u7EBF\u7A0B\u90FD\u662F\u6838\u5FC3\u7EBF\u7A0B\uFF0C\u6838\u5FC3\u7EBF\u7A0B\u4E0D\u4F1A\u88AB\u56DE\u6536\uFF08\u9664\u975E\u8BBE\u7F6E\u4E86executor.allowCoreThreadTimeOut(true)\uFF09\u3002</p><p>\u9002\u7528\u573A\u666F\uFF1A\u9002\u7528\u4E8E\u5904\u7406CPU\u5BC6\u96C6\u578B\u7684\u4EFB\u52A1\uFF0C\u786E\u4FDDCPU\u5728\u957F\u671F\u88AB\u5DE5\u4F5C\u7EBF\u7A0B\u4F7F\u7528\u7684\u60C5\u51B5\u4E0B\uFF0C\u5C3D\u53EF\u80FD\u7684\u5C11\u7684\u5206\u914D\u7EBF\u7A0B\uFF0C\u5373\u9002\u7528\u6267\u884C\u957F\u671F\u7684\u4EFB\u52A1\u3002\u9700\u8981\u6CE8\u610F\u7684\u662F\uFF0CFixedThreadPool \u4E0D\u4F1A\u62D2\u7EDD\u4EFB\u52A1\uFF0C<strong>\u5728\u4EFB\u52A1\u6BD4\u8F83\u591A\u7684\u65F6\u5019\u4F1A\u5BFC\u81F4 OOM\u3002</strong></p><p><strong>SingleThreadExecutor</strong></p><p>\u53EA\u6709\u4E00\u4E2A\u7EBF\u7A0B\u7684\u7EBF\u7A0B\u6C60\u3002</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>public static ExecutionService newSingleThreadExecutor() {
	return new ThreadPoolExecutor(1, 1, 0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;Runnable&gt;());
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4F7F\u7528\u65E0\u754C\u961F\u5217 LinkedBlockingQueue\u3002\u7EBF\u7A0B\u6C60\u53EA\u6709\u4E00\u4E2A\u8FD0\u884C\u7684\u7EBF\u7A0B\uFF0C\u65B0\u6765\u7684\u4EFB\u52A1\u653E\u5165\u5DE5\u4F5C\u961F\u5217\uFF0C\u7EBF\u7A0B\u5904\u7406\u5B8C\u4EFB\u52A1\u5C31\u5FAA\u73AF\u4ECE\u961F\u5217\u91CC\u83B7\u53D6\u4EFB\u52A1\u6267\u884C\u3002\u4FDD\u8BC1\u987A\u5E8F\u7684\u6267\u884C\u5404\u4E2A\u4EFB\u52A1\u3002</p><p>\u9002\u7528\u573A\u666F\uFF1A\u9002\u7528\u4E8E\u4E32\u884C\u6267\u884C\u4EFB\u52A1\u7684\u573A\u666F\uFF0C\u4E00\u4E2A\u4EFB\u52A1\u4E00\u4E2A\u4EFB\u52A1\u5730\u6267\u884C\u3002<strong>\u5728\u4EFB\u52A1\u6BD4\u8F83\u591A\u7684\u65F6\u5019\u4E5F\u662F\u4F1A\u5BFC\u81F4 OOM\u3002</strong></p><p><strong>CachedThreadPool</strong></p><p>\u6839\u636E\u9700\u8981\u521B\u5EFA\u65B0\u7EBF\u7A0B\u7684\u7EBF\u7A0B\u6C60\u3002</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>public static ExecutorService newCachedThreadPool() {
	return new ThreadPoolExecutor(0, Integer.MAX_VALUE, 60L, TimeUnit.SECONDS, new SynchronousQueue&lt;Runnable&gt;());
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5982\u679C\u4E3B\u7EBF\u7A0B\u63D0\u4EA4\u4EFB\u52A1\u7684\u901F\u5EA6\u9AD8\u4E8E\u7EBF\u7A0B\u5904\u7406\u4EFB\u52A1\u7684\u901F\u5EA6\u65F6\uFF0C<code>CachedThreadPool</code> \u4F1A\u4E0D\u65AD\u521B\u5EFA\u65B0\u7684\u7EBF\u7A0B\u3002\u6781\u7AEF\u60C5\u51B5\u4E0B\uFF0C\u8FD9\u6837\u4F1A\u5BFC\u81F4\u8017\u5C3D cpu \u548C\u5185\u5B58\u8D44\u6E90\u3002</p><p>\u4F7F\u7528\u6CA1\u6709\u5BB9\u91CF\u7684SynchronousQueue\u4F5C\u4E3A\u7EBF\u7A0B\u6C60\u5DE5\u4F5C\u961F\u5217\uFF0C\u5F53\u7EBF\u7A0B\u6C60\u6709\u7A7A\u95F2\u7EBF\u7A0B\u65F6\uFF0C<code>SynchronousQueue.offer(Runnable task)</code>\u63D0\u4EA4\u7684\u4EFB\u52A1\u4F1A\u88AB\u7A7A\u95F2\u7EBF\u7A0B\u5904\u7406\uFF0C\u5426\u5219\u4F1A\u521B\u5EFA\u65B0\u7684\u7EBF\u7A0B\u5904\u7406\u4EFB\u52A1\u3002</p><p>\u9002\u7528\u573A\u666F\uFF1A\u7528\u4E8E\u5E76\u53D1\u6267\u884C\u5927\u91CF\u77ED\u671F\u7684\u5C0F\u4EFB\u52A1\u3002<code>CachedThreadPool</code>\u5141\u8BB8\u521B\u5EFA\u7684\u7EBF\u7A0B\u6570\u91CF\u4E3A Integer.MAX_VALUE \uFF0C<strong>\u53EF\u80FD\u4F1A\u521B\u5EFA\u5927\u91CF\u7EBF\u7A0B\uFF0C\u4ECE\u800C\u5BFC\u81F4 OOM\u3002</strong></p><p><strong>ScheduledThreadPoolExecutor</strong></p><p>\u5728\u7ED9\u5B9A\u7684\u5EF6\u8FDF\u540E\u8FD0\u884C\u4EFB\u52A1\uFF0C\u6216\u8005\u5B9A\u671F\u6267\u884C\u4EFB\u52A1\u3002\u5728\u5B9E\u9645\u9879\u76EE\u4E2D\u57FA\u672C\u4E0D\u4F1A\u88AB\u7528\u5230\uFF0C\u56E0\u4E3A\u6709\u5176\u4ED6\u65B9\u6848\u9009\u62E9\u6BD4\u5982<code>quartz</code>\u3002</p><p>\u4F7F\u7528\u7684\u4EFB\u52A1\u961F\u5217 <code>DelayQueue</code> \u5C01\u88C5\u4E86\u4E00\u4E2A <code>PriorityQueue</code>\uFF0C<code>PriorityQueue</code> \u4F1A\u5BF9\u961F\u5217\u4E2D\u7684\u4EFB\u52A1\u8FDB\u884C\u6392\u5E8F\uFF0C\u65F6\u95F4\u65E9\u7684\u4EFB\u52A1\u5148\u88AB\u6267\u884C(\u5373<code>ScheduledFutureTask</code> \u7684 <code>time</code> \u53D8\u91CF\u5C0F\u7684\u5148\u6267\u884C)\uFF0C\u5982\u679Ctime\u76F8\u540C\u5219\u5148\u63D0\u4EA4\u7684\u4EFB\u52A1\u4F1A\u88AB\u5148\u6267\u884C(<code>ScheduledFutureTask</code> \u7684 <code>squenceNumber</code> \u53D8\u91CF\u5C0F\u7684\u5148\u6267\u884C)\u3002</p><p>\u6267\u884C\u5468\u671F\u4EFB\u52A1\u6B65\u9AA4\uFF1A</p><ol><li>\u7EBF\u7A0B\u4ECE <code>DelayQueue</code> \u4E2D\u83B7\u53D6\u5DF2\u5230\u671F\u7684 <code>ScheduledFutureTask\uFF08DelayQueue.take()\uFF09</code>\u3002\u5230\u671F\u4EFB\u52A1\u662F\u6307 <code>ScheduledFutureTask</code>\u7684 time \u5927\u4E8E\u7B49\u4E8E\u5F53\u524D\u7CFB\u7EDF\u7684\u65F6\u95F4\uFF1B</li><li>\u6267\u884C\u8FD9\u4E2A <code>ScheduledFutureTask</code>\uFF1B</li><li>\u4FEE\u6539 <code>ScheduledFutureTask</code> \u7684 time \u53D8\u91CF\u4E3A\u4E0B\u6B21\u5C06\u8981\u88AB\u6267\u884C\u7684\u65F6\u95F4\uFF1B</li><li>\u628A\u8FD9\u4E2A\u4FEE\u6539 time \u4E4B\u540E\u7684 <code>ScheduledFutureTask</code> \u653E\u56DE <code>DelayQueue</code> \u4E2D\uFF08<code>DelayQueue.add()</code>)\u3002</li></ol><p><img src="http://img.dabin-coder.cn/image/scheduled-task.jpg" alt="" loading="lazy"></p><p>\u9002\u7528\u573A\u666F\uFF1A\u5468\u671F\u6027\u6267\u884C\u4EFB\u52A1\u7684\u573A\u666F\uFF0C\u9700\u8981\u9650\u5236\u7EBF\u7A0B\u6570\u91CF\u7684\u573A\u666F\u3002</p><h2 id="\u8FDB\u7A0B\u7EBF\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u8FDB\u7A0B\u7EBF\u7A0B" aria-hidden="true">#</a> \u8FDB\u7A0B\u7EBF\u7A0B</h2><p>\u8FDB\u7A0B\u662F\u6307\u4E00\u4E2A\u5185\u5B58\u4E2D\u8FD0\u884C\u7684\u5E94\u7528\u7A0B\u5E8F\uFF0C\u6BCF\u4E2A\u8FDB\u7A0B\u90FD\u6709\u81EA\u5DF1\u72EC\u7ACB\u7684\u4E00\u5757\u5185\u5B58\u7A7A\u95F4\u3002</p><p>\u7EBF\u7A0B\u662F\u6BD4\u8FDB\u7A0B\u66F4\u5C0F\u7684\u6267\u884C\u5355\u4F4D\uFF0C\u5B83\u662F\u5728\u4E00\u4E2A\u8FDB\u7A0B\u4E2D\u72EC\u7ACB\u7684\u63A7\u5236\u6D41\uFF0C\u4E00\u4E2A\u8FDB\u7A0B\u53EF\u4EE5\u542F\u52A8\u591A\u4E2A\u7EBF\u7A0B\uFF0C\u6BCF\u6761\u7EBF\u7A0B\u5E76\u884C\u6267\u884C\u4E0D\u540C\u7684\u4EFB\u52A1\u3002</p><h3 id="\u7EBF\u7A0B\u7684\u751F\u547D\u5468\u671F" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u7A0B\u7684\u751F\u547D\u5468\u671F" aria-hidden="true">#</a> \u7EBF\u7A0B\u7684\u751F\u547D\u5468\u671F</h3><p><strong>\u521D\u59CB(NEW)</strong>\uFF1A\u7EBF\u7A0B\u88AB\u6784\u5EFA\uFF0C\u8FD8\u6CA1\u6709\u8C03\u7528 start()\u3002</p><p><strong>\u8FD0\u884C(RUNNABLE)</strong>\uFF1A\u5305\u62EC\u64CD\u4F5C\u7CFB\u7EDF\u7684\u5C31\u7EEA\u548C\u8FD0\u884C\u4E24\u79CD\u72B6\u6001\u3002</p><p><strong>\u963B\u585E(BLOCKED)</strong>\uFF1A\u4E00\u822C\u662F\u88AB\u52A8\u7684\uFF0C\u5728\u62A2\u5360\u8D44\u6E90\u4E2D\u5F97\u4E0D\u5230\u8D44\u6E90\uFF0C\u88AB\u52A8\u7684\u6302\u8D77\u5728\u5185\u5B58\uFF0C\u7B49\u5F85\u8D44\u6E90\u91CA\u653E\u5C06\u5176\u5524\u9192\u3002\u7EBF\u7A0B\u88AB\u963B\u585E\u4F1A\u91CA\u653ECPU\uFF0C\u4E0D\u91CA\u653E\u5185\u5B58\u3002</p><p><strong>\u7B49\u5F85(WAITING)</strong>\uFF1A\u8FDB\u5165\u8BE5\u72B6\u6001\u7684\u7EBF\u7A0B\u9700\u8981\u7B49\u5F85\u5176\u4ED6\u7EBF\u7A0B\u505A\u51FA\u4E00\u4E9B\u7279\u5B9A\u52A8\u4F5C\uFF08\u901A\u77E5\u6216\u4E2D\u65AD\uFF09\u3002</p><p><strong>\u8D85\u65F6\u7B49\u5F85(TIMED_WAITING)</strong>\uFF1A\u8BE5\u72B6\u6001\u4E0D\u540C\u4E8EWAITING\uFF0C\u5B83\u53EF\u4EE5\u5728\u6307\u5B9A\u7684\u65F6\u95F4\u540E\u81EA\u884C\u8FD4\u56DE\u3002</p><p><strong>\u7EC8\u6B62(TERMINATED)</strong>\uFF1A\u8868\u793A\u8BE5\u7EBF\u7A0B\u5DF2\u7ECF\u6267\u884C\u5B8C\u6BD5\u3002</p><p><img src="http://img.dabin-coder.cn/image/image-20210909235618175.png" alt="" loading="lazy"></p><blockquote><p>\u56FE\u7247\u6765\u6E90\uFF1AJava\u5E76\u53D1\u7F16\u7A0B\u7684\u827A\u672F</p></blockquote><h3 id="\u8BB2\u8BB2\u7EBF\u7A0B\u4E2D\u65AD" tabindex="-1"><a class="header-anchor" href="#\u8BB2\u8BB2\u7EBF\u7A0B\u4E2D\u65AD" aria-hidden="true">#</a> \u8BB2\u8BB2\u7EBF\u7A0B\u4E2D\u65AD\uFF1F</h3><p>\u7EBF\u7A0B\u4E2D\u65AD\u5373\u7EBF\u7A0B\u8FD0\u884C\u8FC7\u7A0B\u4E2D\u88AB\u5176\u4ED6\u7EBF\u7A0B\u7ED9\u6253\u65AD\u4E86\uFF0C\u5B83\u4E0E stop \u6700\u5927\u7684\u533A\u522B\u662F\uFF1Astop \u662F\u7531\u7CFB\u7EDF\u5F3A\u5236\u7EC8\u6B62\u7EBF\u7A0B\uFF0C\u800C\u7EBF\u7A0B\u4E2D\u65AD\u5219\u662F\u7ED9\u76EE\u6807\u7EBF\u7A0B\u53D1\u9001\u4E00\u4E2A\u4E2D\u65AD\u4FE1\u53F7\uFF0C\u5982\u679C\u76EE\u6807\u7EBF\u7A0B\u6CA1\u6709\u63A5\u6536\u7EBF\u7A0B\u4E2D\u65AD\u7684\u4FE1\u53F7\u5E76\u7ED3\u675F\u7EBF\u7A0B\uFF0C\u7EBF\u7A0B\u5219\u4E0D\u4F1A\u7EC8\u6B62\uFF0C\u5177\u4F53\u662F\u5426\u9000\u51FA\u6216\u8005\u6267\u884C\u5176\u4ED6\u903B\u8F91\u53D6\u51B3\u4E8E\u76EE\u6807\u7EBF\u7A0B\u3002</p><p>\u7EBF\u7A0B\u4E2D\u65AD\u4E09\u4E2A\u91CD\u8981\u7684\u65B9\u6CD5\uFF1A</p><p><strong>1\u3001java.lang.Thread#interrupt</strong></p><p>\u8C03\u7528\u76EE\u6807\u7EBF\u7A0B\u7684<code>interrupt()</code>\u65B9\u6CD5\uFF0C\u7ED9\u76EE\u6807\u7EBF\u7A0B\u53D1\u4E00\u4E2A\u4E2D\u65AD\u4FE1\u53F7\uFF0C\u7EBF\u7A0B\u88AB\u6253\u4E0A\u4E2D\u65AD\u6807\u8BB0\u3002</p><p><strong>2\u3001java.lang.Thread#isInterrupted()</strong></p><p>\u5224\u65AD\u76EE\u6807\u7EBF\u7A0B\u662F\u5426\u88AB\u4E2D\u65AD\uFF0C\u4E0D\u4F1A\u6E05\u9664\u4E2D\u65AD\u6807\u8BB0\u3002</p><p><strong>3\u3001java.lang.Thread#interrupted</strong></p><p>\u5224\u65AD\u76EE\u6807\u7EBF\u7A0B\u662F\u5426\u88AB\u4E2D\u65AD\uFF0C\u4F1A\u6E05\u9664\u4E2D\u65AD\u6807\u8BB0\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Thread</span> thread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token keyword">yield</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// \u54CD\u5E94\u4E2D\u65AD</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isInterrupted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Java\u6280\u672F\u6808\u7EBF\u7A0B\u88AB\u4E2D\u65AD\uFF0C\u7A0B\u5E8F\u9000\u51FA\u3002&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    thread<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    thread<span class="token punctuation">.</span><span class="token function">interrupt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u521B\u5EFA\u7EBF\u7A0B\u6709\u54EA\u51E0\u79CD\u65B9\u5F0F" tabindex="-1"><a class="header-anchor" href="#\u521B\u5EFA\u7EBF\u7A0B\u6709\u54EA\u51E0\u79CD\u65B9\u5F0F" aria-hidden="true">#</a> \u521B\u5EFA\u7EBF\u7A0B\u6709\u54EA\u51E0\u79CD\u65B9\u5F0F\uFF1F</h3><ul><li>\u901A\u8FC7\u6269\u5C55<code>Thread</code>\u7C7B\u6765\u521B\u5EFA\u591A\u7EBF\u7A0B</li><li>\u901A\u8FC7\u5B9E\u73B0<code>Runnable</code>\u63A5\u53E3\u6765\u521B\u5EFA\u591A\u7EBF\u7A0B</li><li>\u5B9E\u73B0<code>Callable</code>\u63A5\u53E3\uFF0C\u901A\u8FC7<code>FutureTask</code>\u63A5\u53E3\u521B\u5EFA\u7EBF\u7A0B\u3002</li><li>\u4F7F\u7528<code>Executor</code>\u6846\u67B6\u6765\u521B\u5EFA\u7EBF\u7A0B\u6C60\u3002</li></ul><p><strong>\u7EE7\u627F Thread \u521B\u5EFA\u7EBF\u7A0B</strong>\u4EE3\u7801\u5982\u4E0B\u3002run()\u65B9\u6CD5\u662F\u7531jvm\u521B\u5EFA\u5B8C\u64CD\u4F5C\u7CFB\u7EDF\u7EA7\u7EBF\u7A0B\u540E\u56DE\u8C03\u7684\u65B9\u6CD5\uFF0C\u4E0D\u53EF\u4EE5\u624B\u52A8\u8C03\u7528\uFF0C\u624B\u52A8\u8C03\u7528\u76F8\u5F53\u4E8E\u8C03\u7528\u666E\u901A\u65B9\u6CD5\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span>: \u7A0B\u5E8F\u5458\u5927\u5F6C
 * <span class="token keyword">@time</span>: 2021-09-11 10:15
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;:&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">MyThread</span> mThread1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">MyThread</span> mThread2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">MyThread</span> myThread3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mThread1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mThread2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        myThread3<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Runnable \u521B\u5EFA\u7EBF\u7A0B\u4EE3\u7801</strong>\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span>: \u7A0B\u5E8F\u5458\u5927\u5F6C
 * <span class="token keyword">@time</span>: 2021-09-11 10:04
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RunnableTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span>  <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Runnable1</span> r <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Runnable1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Thread</span> thread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
        thread<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u4E3B\u7EBF\u7A0B\uFF1A[&quot;</span><span class="token operator">+</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Runnable1</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u5F53\u524D\u7EBF\u7A0B\uFF1A&quot;</span><span class="token operator">+</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5B9E\u73B0Runnable\u63A5\u53E3\u6BD4\u7EE7\u627FThread\u7C7B\u6240\u5177\u6709\u7684\u4F18\u52BF\uFF1A</p><ol><li>\u53EF\u4EE5\u907F\u514Djava\u4E2D\u7684\u5355\u7EE7\u627F\u7684\u9650\u5236</li><li>\u7EBF\u7A0B\u6C60\u53EA\u80FD\u653E\u5165\u5B9E\u73B0Runable\u6216Callable\u7C7B\u7EBF\u7A0B\uFF0C\u4E0D\u80FD\u76F4\u63A5\u653E\u5165\u7EE7\u627FThread\u7684\u7C7B</li></ol><p><strong>Callable \u521B\u5EFA\u7EBF\u7A0B\u4EE3\u7801</strong>\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span>: \u7A0B\u5E8F\u5458\u5927\u5F6C
 * <span class="token keyword">@time</span>: 2021-09-11 10:21
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CallableTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Callable1</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Callable1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//\u5F02\u6B65\u8BA1\u7B97\u7684\u7ED3\u679C</span>
        <span class="token class-name">FutureTask</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FutureTask</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">//\u7B49\u5F85\u4EFB\u52A1\u5B8C\u6210\uFF0C\u8FD4\u56DE\u7ED3\u679C</span>
            <span class="token keyword">int</span> sum <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>sum<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> <span class="token operator">|</span> <span class="token class-name">ExecutionException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Callable1</span> <span class="token keyword">implements</span> <span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            sum <span class="token operator">+=</span> i<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> sum<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u4F7F\u7528 Executor \u521B\u5EFA\u7EBF\u7A0B\u4EE3\u7801</strong>\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span>: \u7A0B\u5E8F\u5458\u5927\u5F6C
 * <span class="token keyword">@time</span>: 2021-09-11 10:44
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ExecutorsTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//\u83B7\u53D6ExecutorService\u5B9E\u4F8B\uFF0C\u751F\u4EA7\u7981\u7528\uFF0C\u9700\u8981\u624B\u52A8\u521B\u5EFA\u7EBF\u7A0B\u6C60</span>
        <span class="token class-name">ExecutorService</span> executorService <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newCachedThreadPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//\u63D0\u4EA4\u4EFB\u52A1</span>
        executorService<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RunnableDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">RunnableDemo</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u5927\u5F6C&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u4EC0\u4E48\u662F\u7EBF\u7A0B\u6B7B\u9501" tabindex="-1"><a class="header-anchor" href="#\u4EC0\u4E48\u662F\u7EBF\u7A0B\u6B7B\u9501" aria-hidden="true">#</a> \u4EC0\u4E48\u662F\u7EBF\u7A0B\u6B7B\u9501\uFF1F</h3><p>\u7EBF\u7A0B\u6B7B\u9501\u662F\u6307\u4E24\u4E2A\u6216\u4E24\u4E2A\u4EE5\u4E0A\u7684\u7EBF\u7A0B\u5728\u6267\u884C\u8FC7\u7A0B\u4E2D\uFF0C\u56E0\u4E89\u593A\u8D44\u6E90\u800C\u9020\u6210\u7684\u4E00\u79CD\u4E92\u76F8\u7B49\u5F85\u7684\u73B0\u8C61\u3002\u82E5\u65E0\u5916\u529B\u4F5C\u7528\uFF0C\u5B83\u4EEC\u90FD\u5C06\u65E0\u6CD5\u63A8\u8FDB\u4E0B\u53BB\u3002</p><p>\u5982\u4E0B\u56FE\u6240\u793A\uFF0C\u7EBF\u7A0B A \u6301\u6709\u8D44\u6E90 2\uFF0C\u7EBF\u7A0B B \u6301\u6709\u8D44\u6E90 1\uFF0C\u4ED6\u4EEC\u540C\u65F6\u90FD\u60F3\u7533\u8BF7\u5BF9\u65B9\u6301\u6709\u7684\u8D44\u6E90\uFF0C\u6240\u4EE5\u8FD9\u4E24\u4E2A\u7EBF\u7A0B\u5C31\u4F1A\u4E92\u76F8\u7B49\u5F85\u800C\u8FDB\u5165\u6B7B\u9501\u72B6\u6001\u3002</p><p><img src="http://img.dabin-coder.cn/image/\u6B7B\u9501.png" alt="\u6B7B\u9501" loading="lazy"></p><p>\u4E0B\u9762\u901A\u8FC7\u4F8B\u5B50\u8BF4\u660E\u7EBF\u7A0B\u6B7B\u9501\uFF0C\u4EE3\u7801\u6765\u81EA\u5E76\u53D1\u7F16\u7A0B\u4E4B\u7F8E\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DeadLockDemo</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Object</span> resource1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//\u8D44\u6E90 1</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Object</span> resource2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//\u8D44\u6E90 2</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>resource1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;get resource1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;waiting get resource2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>resource2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;get resource2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;\u7EBF\u7A0B 1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>resource2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;get resource2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;waiting get resource1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>resource1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;get resource1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;\u7EBF\u7A0B 2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4EE3\u7801\u8F93\u51FA\u5982\u4E0B\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Thread</span><span class="token punctuation">[</span>\u7EBF\u7A0B <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span>main<span class="token punctuation">]</span>get resource1
<span class="token class-name">Thread</span><span class="token punctuation">[</span>\u7EBF\u7A0B <span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span>main<span class="token punctuation">]</span>get resource2
<span class="token class-name">Thread</span><span class="token punctuation">[</span>\u7EBF\u7A0B <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span>main<span class="token punctuation">]</span>waiting get resource2
<span class="token class-name">Thread</span><span class="token punctuation">[</span>\u7EBF\u7A0B <span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span>main<span class="token punctuation">]</span>waiting get resource1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7EBF\u7A0B A \u901A\u8FC7 <code>synchronized</code> (resource1) \u83B7\u5F97 resource1 \u7684\u76D1\u89C6\u5668\u9501\uFF0C\u7136\u540E\u901A\u8FC7 <code>Thread.sleep(1000)</code>\u3002\u8BA9\u7EBF\u7A0B A \u4F11\u7720 1s \u4E3A\u7684\u662F\u8BA9\u7EBF\u7A0B B \u5F97\u5230\u6267\u884C\u7136\u540E\u83B7\u53D6\u5230 resource2 \u7684\u76D1\u89C6\u5668\u9501\u3002\u7EBF\u7A0B A \u548C\u7EBF\u7A0B B \u4F11\u7720\u7ED3\u675F\u4E86\u90FD\u5F00\u59CB\u4F01\u56FE\u8BF7\u6C42\u83B7\u53D6\u5BF9\u65B9\u7684\u8D44\u6E90\uFF0C\u7136\u540E\u8FD9\u4E24\u4E2A\u7EBF\u7A0B\u5C31\u4F1A\u9677\u5165\u4E92\u76F8\u7B49\u5F85\u7684\u72B6\u6001\uFF0C\u8FD9\u4E5F\u5C31\u4EA7\u751F\u4E86\u6B7B\u9501\u3002</p><h3 id="\u7EBF\u7A0B\u6B7B\u9501\u600E\u4E48\u4EA7\u751F-\u600E\u4E48\u907F\u514D" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u7A0B\u6B7B\u9501\u600E\u4E48\u4EA7\u751F-\u600E\u4E48\u907F\u514D" aria-hidden="true">#</a> \u7EBF\u7A0B\u6B7B\u9501\u600E\u4E48\u4EA7\u751F\uFF1F\u600E\u4E48\u907F\u514D\uFF1F</h3><p><strong>\u6B7B\u9501\u4EA7\u751F\u7684\u56DB\u4E2A\u5FC5\u8981\u6761\u4EF6</strong>\uFF1A</p><ul><li><p>\u4E92\u65A5\uFF1A\u4E00\u4E2A\u8D44\u6E90\u6BCF\u6B21\u53EA\u80FD\u88AB\u4E00\u4E2A\u8FDB\u7A0B\u4F7F\u7528</p></li><li><p>\u8BF7\u6C42\u4E0E\u4FDD\u6301\uFF1A\u4E00\u4E2A\u8FDB\u7A0B\u56E0\u8BF7\u6C42\u8D44\u6E90\u800C\u963B\u585E\u65F6\uFF0C\u4E0D\u91CA\u653E\u83B7\u5F97\u7684\u8D44\u6E90</p></li><li><p>\u4E0D\u5265\u593A\uFF1A\u8FDB\u7A0B\u5DF2\u83B7\u5F97\u7684\u8D44\u6E90\uFF0C\u5728\u672A\u4F7F\u7528\u4E4B\u524D\uFF0C\u4E0D\u80FD\u5F3A\u884C\u5265\u593A</p></li><li><p>\u5FAA\u73AF\u7B49\u5F85\uFF1A\u8FDB\u7A0B\u4E4B\u95F4\u5FAA\u73AF\u7B49\u5F85\u7740\u8D44\u6E90</p></li></ul><p><strong>\u907F\u514D\u6B7B\u9501\u7684\u65B9\u6CD5</strong>\uFF1A</p><ul><li>\u4E92\u65A5\u6761\u4EF6\u4E0D\u80FD\u7834\u574F\uFF0C\u56E0\u4E3A\u52A0\u9501\u5C31\u662F\u4E3A\u4E86\u4FDD\u8BC1\u4E92\u65A5</li><li>\u4E00\u6B21\u6027\u7533\u8BF7\u6240\u6709\u7684\u8D44\u6E90\uFF0C\u907F\u514D\u7EBF\u7A0B\u5360\u6709\u8D44\u6E90\u800C\u4E14\u5728\u7B49\u5F85\u5176\u4ED6\u8D44\u6E90</li><li>\u5360\u6709\u90E8\u5206\u8D44\u6E90\u7684\u7EBF\u7A0B\u8FDB\u4E00\u6B65\u7533\u8BF7\u5176\u4ED6\u8D44\u6E90\u65F6\uFF0C\u5982\u679C\u7533\u8BF7\u4E0D\u5230\uFF0C\u4E3B\u52A8\u91CA\u653E\u5B83\u5360\u6709\u7684\u8D44\u6E90</li><li>\u6309\u5E8F\u7533\u8BF7\u8D44\u6E90</li></ul><h3 id="\u7EBF\u7A0Brun\u548Cstart\u7684\u533A\u522B" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u7A0Brun\u548Cstart\u7684\u533A\u522B" aria-hidden="true">#</a> \u7EBF\u7A0Brun\u548Cstart\u7684\u533A\u522B\uFF1F</h3><ul><li>\u5F53\u7A0B\u5E8F\u8C03\u7528<code>start()</code>\u65B9\u6CD5\uFF0C\u5C06\u4F1A\u521B\u5EFA\u4E00\u4E2A\u65B0\u7EBF\u7A0B\u53BB\u6267\u884C<code>run()</code>\u65B9\u6CD5\u4E2D\u7684\u4EE3\u7801\u3002<code>run()</code>\u5C31\u50CF\u4E00\u4E2A\u666E\u901A\u65B9\u6CD5\u4E00\u6837\uFF0C\u76F4\u63A5\u8C03\u7528<code>run()</code>\u7684\u8BDD\uFF0C\u4E0D\u4F1A\u521B\u5EFA\u65B0\u7EBF\u7A0B\u3002</li><li>\u4E00\u4E2A\u7EBF\u7A0B\u7684 <code>start()</code> \u65B9\u6CD5\u53EA\u80FD\u8C03\u7528\u4E00\u6B21\uFF0C\u591A\u6B21\u8C03\u7528\u4F1A\u629B\u51FA java.lang.IllegalThreadStateException \u5F02\u5E38\u3002<code>run()</code> \u65B9\u6CD5\u5219\u6CA1\u6709\u9650\u5236\u3002</li></ul><h3 id="\u7EBF\u7A0B\u90FD\u6709\u54EA\u4E9B\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u7A0B\u90FD\u6709\u54EA\u4E9B\u65B9\u6CD5" aria-hidden="true">#</a> \u7EBF\u7A0B\u90FD\u6709\u54EA\u4E9B\u65B9\u6CD5\uFF1F</h3><p><strong>start</strong></p><p>\u7528\u4E8E\u542F\u52A8\u7EBF\u7A0B\u3002</p><p><strong>getPriority</strong></p><p>\u83B7\u53D6\u7EBF\u7A0B\u4F18\u5148\u7EA7\uFF0C\u9ED8\u8BA4\u662F5\uFF0C\u7EBF\u7A0B\u9ED8\u8BA4\u4F18\u5148\u7EA7\u4E3A5\uFF0C\u5982\u679C\u4E0D\u624B\u52A8\u6307\u5B9A\uFF0C\u90A3\u4E48\u7EBF\u7A0B\u4F18\u5148\u7EA7\u5177\u6709\u7EE7\u627F\u6027\uFF0C\u6BD4\u5982\u7EBF\u7A0BA\u542F\u52A8\u7EBF\u7A0BB\uFF0C\u90A3\u4E48\u7EBF\u7A0BB\u7684\u4F18\u5148\u7EA7\u548C\u7EBF\u7A0BA\u7684\u4F18\u5148\u7EA7\u76F8\u540C</p><p><strong>setPriority</strong></p><p>\u8BBE\u7F6E\u7EBF\u7A0B\u4F18\u5148\u7EA7\u3002CPU\u4F1A\u5C3D\u91CF\u5C06\u6267\u884C\u8D44\u6E90\u8BA9\u7ED9\u4F18\u5148\u7EA7\u6BD4\u8F83\u9AD8\u7684\u7EBF\u7A0B\u3002</p><p><strong>interrupt</strong></p><p>\u544A\u8BC9\u7EBF\u7A0B\uFF0C\u4F60\u5E94\u8BE5\u4E2D\u65AD\u4E86\uFF0C\u5177\u4F53\u5230\u5E95\u4E2D\u65AD\u8FD8\u662F\u7EE7\u7EED\u8FD0\u884C\uFF0C\u7531\u88AB\u901A\u77E5\u7684\u7EBF\u7A0B\u81EA\u5DF1\u5904\u7406\u3002</p><p>\u5F53\u5BF9\u4E00\u4E2A\u7EBF\u7A0B\u8C03\u7528 interrupt() \u65F6\uFF0C\u6709\u4E24\u79CD\u60C5\u51B5\uFF1A</p><ol><li><p>\u5982\u679C\u7EBF\u7A0B\u5904\u4E8E\u88AB\u963B\u585E\u72B6\u6001\uFF08\u4F8B\u5982\u5904\u4E8Esleep, wait, join \u7B49\u72B6\u6001\uFF09\uFF0C\u90A3\u4E48\u7EBF\u7A0B\u5C06\u7ACB\u5373\u9000\u51FA\u88AB\u963B\u585E\u72B6\u6001\uFF0C\u5E76\u629B\u51FA\u4E00\u4E2AInterruptedException\u5F02\u5E38\u3002</p></li><li><p>\u5982\u679C\u7EBF\u7A0B\u5904\u4E8E\u6B63\u5E38\u6D3B\u52A8\u72B6\u6001\uFF0C\u90A3\u4E48\u4F1A\u5C06\u8BE5\u7EBF\u7A0B\u7684\u4E2D\u65AD\u6807\u5FD7\u8BBE\u7F6E\u4E3A true\u3002\u4E0D\u8FC7\uFF0C\u88AB\u8BBE\u7F6E\u4E2D\u65AD\u6807\u5FD7\u7684\u7EBF\u7A0B\u53EF\u4EE5\u7EE7\u7EED\u6B63\u5E38\u8FD0\u884C\uFF0C\u4E0D\u53D7\u5F71\u54CD\u3002</p></li></ol><p>interrupt() \u5E76\u4E0D\u80FD\u771F\u6B63\u7684\u4E2D\u65AD\u7EBF\u7A0B\uFF0C\u9700\u8981\u88AB\u8C03\u7528\u7684\u7EBF\u7A0B\u81EA\u5DF1\u8FDB\u884C\u914D\u5408\u624D\u884C\u3002</p><p><strong>join</strong></p><p>\u7B49\u5F85\u5176\u4ED6\u7EBF\u7A0B\u7EC8\u6B62\u3002\u5728\u5F53\u524D\u7EBF\u7A0B\u4E2D\u8C03\u7528\u53E6\u4E00\u4E2A\u7EBF\u7A0B\u7684join()\u65B9\u6CD5\uFF0C\u5219\u5F53\u524D\u7EBF\u7A0B\u8F6C\u5165\u963B\u585E\u72B6\u6001\uFF0C\u76F4\u5230\u53E6\u4E00\u4E2A\u8FDB\u7A0B\u8FD0\u884C\u7ED3\u675F\uFF0C\u5F53\u524D\u7EBF\u7A0B\u518D\u7531\u963B\u585E\u8F6C\u4E3A\u5C31\u7EEA\u72B6\u6001\u3002</p><p><strong>yield</strong></p><p>\u6682\u505C\u5F53\u524D\u6B63\u5728\u6267\u884C\u7684\u7EBF\u7A0B\u5BF9\u8C61\uFF0C\u628A\u6267\u884C\u673A\u4F1A\u8BA9\u7ED9\u76F8\u540C\u6216\u8005\u66F4\u9AD8\u4F18\u5148\u7EA7\u7684\u7EBF\u7A0B\u3002</p><p><strong>sleep</strong></p><p>\u4F7F\u7EBF\u7A0B\u8F6C\u5230\u963B\u585E\u72B6\u6001\u3002millis\u53C2\u6570\u8BBE\u5B9A\u7761\u7720\u7684\u65F6\u95F4\uFF0C\u4EE5\u6BEB\u79D2\u4E3A\u5355\u4F4D\u3002\u5F53\u7761\u7720\u7ED3\u675F\u540E\uFF0C\u7EBF\u7A0B\u81EA\u52A8\u8F6C\u4E3ARunnable\u72B6\u6001\u3002</p><h2 id="volatile\u5E95\u5C42\u539F\u7406" tabindex="-1"><a class="header-anchor" href="#volatile\u5E95\u5C42\u539F\u7406" aria-hidden="true">#</a> volatile\u5E95\u5C42\u539F\u7406</h2><p><code>volatile</code>\u662F\u8F7B\u91CF\u7EA7\u7684\u540C\u6B65\u673A\u5236\uFF0C<code>volatile</code>\u4FDD\u8BC1\u53D8\u91CF\u5BF9\u6240\u6709\u7EBF\u7A0B\u7684\u53EF\u89C1\u6027\uFF0C\u4E0D\u4FDD\u8BC1\u539F\u5B50\u6027\u3002</p><ol><li>\u5F53\u5BF9<code>volatile</code>\u53D8\u91CF\u8FDB\u884C\u5199\u64CD\u4F5C\u7684\u65F6\u5019\uFF0CJVM\u4F1A\u5411\u5904\u7406\u5668\u53D1\u9001\u4E00\u6761<code>LOCK</code>\u524D\u7F00\u7684\u6307\u4EE4\uFF0C\u5C06\u8BE5\u53D8\u91CF\u6240\u5728\u7F13\u5B58\u884C\u7684\u6570\u636E\u5199\u56DE\u7CFB\u7EDF\u5185\u5B58\u3002</li><li>\u7531\u4E8E\u7F13\u5B58\u4E00\u81F4\u6027\u534F\u8BAE\uFF0C\u6BCF\u4E2A\u5904\u7406\u5668\u901A\u8FC7\u55C5\u63A2\u5728\u603B\u7EBF\u4E0A\u4F20\u64AD\u7684\u6570\u636E\u6765\u68C0\u67E5\u81EA\u5DF1\u7684\u7F13\u5B58\u662F\u4E0D\u662F\u8FC7\u671F\u4E86\uFF0C\u5F53\u5904\u7406\u5668\u53D1\u73B0\u81EA\u5DF1\u7F13\u5B58\u884C\u5BF9\u5E94\u7684\u5185\u5B58\u5730\u5740\u88AB\u4FEE\u6539\uFF0C\u5C31\u4F1A\u5C06\u5F53\u524D\u5904\u7406\u5668\u7684\u7F13\u5B58\u884C\u7F6E\u4E3A\u65E0\u6548\u72B6\u6001\uFF0C\u5F53\u5904\u7406\u5668\u5BF9\u8FD9\u4E2A\u6570\u636E\u8FDB\u884C\u4FEE\u6539\u64CD\u4F5C\u7684\u65F6\u5019\uFF0C\u4F1A\u91CD\u65B0\u4ECE\u7CFB\u7EDF\u5185\u5B58\u4E2D\u628A\u6570\u636E\u8BFB\u5230\u5904\u7406\u5668\u7F13\u5B58\u4E2D\u3002</li></ol><blockquote><p>\u6765\u770B\u770B\u7F13\u5B58\u4E00\u81F4\u6027\u534F\u8BAE\u662F\u4EC0\u4E48\u3002</p><p><strong>\u7F13\u5B58\u4E00\u81F4\u6027\u534F\u8BAE</strong>\uFF1A\u5F53CPU\u5199\u6570\u636E\u65F6\uFF0C\u5982\u679C\u53D1\u73B0\u64CD\u4F5C\u7684\u53D8\u91CF\u662F\u5171\u4EAB\u53D8\u91CF\uFF0C\u5373\u5728\u5176\u4ED6CPU\u4E2D\u4E5F\u5B58\u5728\u8BE5\u53D8\u91CF\u7684\u526F\u672C\uFF0C\u4F1A\u53D1\u51FA\u4FE1\u53F7\u901A\u77E5\u5176\u4ED6CPU\u5C06\u8BE5\u53D8\u91CF\u7684\u7F13\u5B58\u884C\u7F6E\u4E3A\u65E0\u6548\u72B6\u6001\uFF0C\u56E0\u6B64\u5F53\u5176\u4ED6CPU\u9700\u8981\u8BFB\u53D6\u8FD9\u4E2A\u53D8\u91CF\u65F6\uFF0C\u5C31\u4F1A\u4ECE\u5185\u5B58\u91CD\u65B0\u8BFB\u53D6\u3002</p></blockquote><p><code>volatile</code>\u5173\u952E\u5B57\u7684\u4E24\u4E2A\u4F5C\u7528\uFF1A</p><ol><li>\u4FDD\u8BC1\u4E86\u4E0D\u540C\u7EBF\u7A0B\u5BF9\u5171\u4EAB\u53D8\u91CF\u8FDB\u884C\u64CD\u4F5C\u65F6\u7684<strong>\u53EF\u89C1\u6027</strong>\uFF0C\u5373\u4E00\u4E2A\u7EBF\u7A0B\u4FEE\u6539\u4E86\u67D0\u4E2A\u53D8\u91CF\u7684\u503C\uFF0C\u8FD9\u65B0\u503C\u5BF9\u5176\u4ED6\u7EBF\u7A0B\u6765\u8BF4\u662F\u7ACB\u5373\u53EF\u89C1\u7684\u3002</li><li>\u7981\u6B62\u8FDB\u884C<strong>\u6307\u4EE4\u91CD\u6392\u5E8F</strong>\u3002</li></ol><blockquote><p>\u6307\u4EE4\u91CD\u6392\u5E8F\u662FJVM\u4E3A\u4E86\u4F18\u5316\u6307\u4EE4\uFF0C\u63D0\u9AD8\u7A0B\u5E8F\u8FD0\u884C\u6548\u7387\uFF0C\u5728\u4E0D\u5F71\u54CD\u5355\u7EBF\u7A0B\u7A0B\u5E8F\u6267\u884C\u7ED3\u679C\u7684\u524D\u63D0\u4E0B\uFF0C\u5C3D\u53EF\u80FD\u5730\u63D0\u9AD8\u5E76\u884C\u5EA6\u3002Java\u7F16\u8BD1\u5668\u4F1A\u5728\u751F\u6210\u6307\u4EE4\u7CFB\u5217\u65F6\u5728\u9002\u5F53\u7684\u4F4D\u7F6E\u4F1A\u63D2\u5165<code>\u5185\u5B58\u5C4F\u969C</code>\u6307\u4EE4\u6765\u7981\u6B62\u5904\u7406\u5668\u91CD\u6392\u5E8F\u3002\u63D2\u5165\u4E00\u4E2A\u5185\u5B58\u5C4F\u969C\uFF0C\u76F8\u5F53\u4E8E\u544A\u8BC9CPU\u548C\u7F16\u8BD1\u5668\u5148\u4E8E\u8FD9\u4E2A\u547D\u4EE4\u7684\u5FC5\u987B\u5148\u6267\u884C\uFF0C\u540E\u4E8E\u8FD9\u4E2A\u547D\u4EE4\u7684\u5FC5\u987B\u540E\u6267\u884C\u3002\u5BF9\u4E00\u4E2Avolatile\u5B57\u6BB5\u8FDB\u884C\u5199\u64CD\u4F5C\uFF0CJava\u5185\u5B58\u6A21\u578B\u5C06\u5728\u5199\u64CD\u4F5C\u540E\u63D2\u5165\u4E00\u4E2A\u5199\u5C4F\u969C\u6307\u4EE4\uFF0C\u8FD9\u4E2A\u6307\u4EE4\u4F1A\u628A\u4E4B\u524D\u7684\u5199\u5165\u503C\u90FD\u5237\u65B0\u5230\u5185\u5B58\u3002</p></blockquote><h2 id="synchronized\u7684\u7528\u6CD5\u6709\u54EA\u4E9B" tabindex="-1"><a class="header-anchor" href="#synchronized\u7684\u7528\u6CD5\u6709\u54EA\u4E9B" aria-hidden="true">#</a> synchronized\u7684\u7528\u6CD5\u6709\u54EA\u4E9B?</h2><ol><li><strong>\u4FEE\u9970\u666E\u901A\u65B9\u6CD5</strong>\uFF1A\u4F5C\u7528\u4E8E\u5F53\u524D\u5BF9\u8C61\u5B9E\u4F8B\uFF0C\u8FDB\u5165\u540C\u6B65\u4EE3\u7801\u524D\u8981\u83B7\u5F97\u5F53\u524D\u5BF9\u8C61\u5B9E\u4F8B\u7684\u9501</li><li><strong>\u4FEE\u9970\u9759\u6001\u65B9\u6CD5</strong>\uFF1A\u4F5C\u7528\u4E8E\u5F53\u524D\u7C7B\uFF0C\u8FDB\u5165\u540C\u6B65\u4EE3\u7801\u524D\u8981\u83B7\u5F97\u5F53\u524D\u7C7B\u5BF9\u8C61\u7684\u9501\uFF0Csynchronized\u5173\u952E\u5B57\u52A0\u5230static \u9759\u6001\u65B9\u6CD5\u548C synchronized(class)\u4EE3\u7801\u5757\u4E0A\u90FD\u662F\u662F\u7ED9 Class \u7C7B\u4E0A\u9501</li><li><strong>\u4FEE\u9970\u4EE3\u7801\u5757</strong>\uFF1A\u6307\u5B9A\u52A0\u9501\u5BF9\u8C61\uFF0C\u5BF9\u7ED9\u5B9A\u5BF9\u8C61\u52A0\u9501\uFF0C\u8FDB\u5165\u540C\u6B65\u4EE3\u7801\u5E93\u524D\u8981\u83B7\u5F97\u7ED9\u5B9A\u5BF9\u8C61\u7684\u9501</li></ol><h2 id="synchronized\u7684\u4F5C\u7528\u6709\u54EA\u4E9B" tabindex="-1"><a class="header-anchor" href="#synchronized\u7684\u4F5C\u7528\u6709\u54EA\u4E9B" aria-hidden="true">#</a> synchronized\u7684\u4F5C\u7528\u6709\u54EA\u4E9B\uFF1F</h2><p><strong>\u539F\u5B50\u6027</strong>\uFF1A\u786E\u4FDD\u7EBF\u7A0B\u4E92\u65A5\u7684\u8BBF\u95EE\u540C\u6B65\u4EE3\u7801\uFF1B</p><p><strong>\u53EF\u89C1\u6027</strong>\uFF1A\u4FDD\u8BC1\u5171\u4EAB\u53D8\u91CF\u7684\u4FEE\u6539\u80FD\u591F\u53CA\u65F6\u53EF\u89C1\uFF1B</p><p><strong>\u6709\u5E8F\u6027</strong>\uFF1A\u6709\u6548\u89E3\u51B3\u91CD\u6392\u5E8F\u95EE\u9898\u3002</p><h2 id="synchronized-\u5E95\u5C42\u5B9E\u73B0\u539F\u7406" tabindex="-1"><a class="header-anchor" href="#synchronized-\u5E95\u5C42\u5B9E\u73B0\u539F\u7406" aria-hidden="true">#</a> synchronized \u5E95\u5C42\u5B9E\u73B0\u539F\u7406\uFF1F</h2><p>synchronized \u540C\u6B65\u4EE3\u7801\u5757\u7684\u5B9E\u73B0\u662F\u901A\u8FC7 <code>monitorenter</code> \u548C <code>monitorexit</code> \u6307\u4EE4\uFF0C\u5176\u4E2D <code>monitorenter</code> \u6307\u4EE4\u6307\u5411\u540C\u6B65\u4EE3\u7801\u5757\u7684\u5F00\u59CB\u4F4D\u7F6E\uFF0C<code>monitorexit</code> \u6307\u4EE4\u5219\u6307\u660E\u540C\u6B65\u4EE3\u7801\u5757\u7684\u7ED3\u675F\u4F4D\u7F6E\u3002\u5F53\u6267\u884C <code>monitorenter</code> \u6307\u4EE4\u65F6\uFF0C\u7EBF\u7A0B\u8BD5\u56FE\u83B7\u53D6\u9501\u4E5F\u5C31\u662F\u83B7\u53D6 <code>monitor</code>\u7684\u6301\u6709\u6743\uFF08monitor\u5BF9\u8C61\u5B58\u5728\u4E8E\u6BCF\u4E2AJava\u5BF9\u8C61\u7684\u5BF9\u8C61\u5934\u4E2D\uFF0C synchronized \u9501\u4FBF\u662F\u901A\u8FC7\u8FD9\u79CD\u65B9\u5F0F\u83B7\u53D6\u9501\u7684\uFF0C\u4E5F\u662F\u4E3A\u4EC0\u4E48Java\u4E2D\u4EFB\u610F\u5BF9\u8C61\u53EF\u4EE5\u4F5C\u4E3A\u9501\u7684\u539F\u56E0\uFF09\u3002</p><p>\u5176\u5185\u90E8\u5305\u542B\u4E00\u4E2A\u8BA1\u6570\u5668\uFF0C\u5F53\u8BA1\u6570\u5668\u4E3A0\u5219\u53EF\u4EE5\u6210\u529F\u83B7\u53D6\uFF0C\u83B7\u53D6\u540E\u5C06\u9501\u8BA1\u6570\u5668\u8BBE\u4E3A1\u4E5F\u5C31\u662F\u52A01\u3002\u76F8\u5E94\u7684\u5728\u6267\u884C <code>monitorexit</code> \u6307\u4EE4\u540E\uFF0C\u5C06\u9501\u8BA1\u6570\u5668\u8BBE\u4E3A0 \uFF0C\u8868\u660E\u9501\u88AB\u91CA\u653E\u3002\u5982\u679C\u83B7\u53D6\u5BF9\u8C61\u9501\u5931\u8D25\uFF0C\u90A3\u5F53\u524D\u7EBF\u7A0B\u5C31\u8981\u963B\u585E\u7B49\u5F85\uFF0C\u76F4\u5230\u9501\u88AB\u53E6\u5916\u4E00\u4E2A\u7EBF\u7A0B\u91CA\u653E\u4E3A\u6B62</p><p>synchronized \u4FEE\u9970\u7684\u65B9\u6CD5\u5E76\u6CA1\u6709 <code>monitorenter</code> \u6307\u4EE4\u548C <code>monitorexit</code> \u6307\u4EE4\uFF0C\u53D6\u5F97\u4EE3\u4E4B\u7684\u786E\u5B9E\u662F<code>ACC_SYNCHRONIZED</code> \u6807\u8BC6\uFF0C\u8BE5\u6807\u8BC6\u6307\u660E\u4E86\u8BE5\u65B9\u6CD5\u662F\u4E00\u4E2A\u540C\u6B65\u65B9\u6CD5\uFF0CJVM \u901A\u8FC7\u8BE5 <code>ACC_SYNCHRONIZED</code> \u8BBF\u95EE\u6807\u5FD7\u6765\u8FA8\u522B\u4E00\u4E2A\u65B9\u6CD5\u662F\u5426\u58F0\u660E\u4E3A\u540C\u6B65\u65B9\u6CD5\uFF0C\u4ECE\u800C\u6267\u884C\u76F8\u5E94\u7684\u540C\u6B65\u8C03\u7528\u3002</p><h2 id="volatile\u548Csynchronized\u7684\u533A\u522B\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#volatile\u548Csynchronized\u7684\u533A\u522B\u662F\u4EC0\u4E48" aria-hidden="true">#</a> volatile\u548Csynchronized\u7684\u533A\u522B\u662F\u4EC0\u4E48\uFF1F</h2><ol><li><code>volatile</code>\u53EA\u80FD\u4F7F\u7528\u5728\u53D8\u91CF\u4E0A\uFF1B\u800C<code>synchronized</code>\u53EF\u4EE5\u5728\u7C7B\uFF0C\u53D8\u91CF\uFF0C\u65B9\u6CD5\u548C\u4EE3\u7801\u5757\u4E0A\u3002</li><li><code>volatile</code>\u81F3\u4FDD\u8BC1\u53EF\u89C1\u6027\uFF1B<code>synchronized</code>\u4FDD\u8BC1\u539F\u5B50\u6027\u4E0E\u53EF\u89C1\u6027\u3002</li><li><code>volatile</code>\u7981\u7528\u6307\u4EE4\u91CD\u6392\u5E8F\uFF1B<code>synchronized</code>\u4E0D\u4F1A\u3002</li><li><code>volatile</code>\u4E0D\u4F1A\u9020\u6210\u963B\u585E\uFF1B<code>synchronized</code>\u4F1A\u3002</li></ol><h2 id="reentrantlock\u548Csynchronized\u533A\u522B" tabindex="-1"><a class="header-anchor" href="#reentrantlock\u548Csynchronized\u533A\u522B" aria-hidden="true">#</a> ReentrantLock\u548Csynchronized\u533A\u522B</h2><ol><li>\u4F7F\u7528synchronized\u5173\u952E\u5B57\u5B9E\u73B0\u540C\u6B65\uFF0C\u7EBF\u7A0B\u6267\u884C\u5B8C\u540C\u6B65\u4EE3\u7801\u5757\u4F1A<strong>\u81EA\u52A8\u91CA\u653E\u9501</strong>\uFF0C\u800CReentrantLock\u9700\u8981\u624B\u52A8\u91CA\u653E\u9501\u3002</li><li>synchronized\u662F<strong>\u975E\u516C\u5E73\u9501</strong>\uFF0CReentrantLock\u53EF\u4EE5\u8BBE\u7F6E\u4E3A\u516C\u5E73\u9501\u3002</li><li>ReentrantLock\u4E0A\u7B49\u5F85\u83B7\u53D6\u9501\u7684\u7EBF\u7A0B\u662F<strong>\u53EF\u4E2D\u65AD\u7684</strong>\uFF0C\u7EBF\u7A0B\u53EF\u4EE5\u653E\u5F03\u7B49\u5F85\u9501\u3002\u800Csynchonized\u4F1A\u65E0\u9650\u671F\u7B49\u5F85\u4E0B\u53BB\u3002</li><li>ReentrantLock <strong>\u53EF\u4EE5\u8BBE\u7F6E\u8D85\u65F6\u83B7\u53D6\u9501</strong>\u3002\u5728\u6307\u5B9A\u7684\u622A\u6B62\u65F6\u95F4\u4E4B\u524D\u83B7\u53D6\u9501\uFF0C\u5982\u679C\u622A\u6B62\u65F6\u95F4\u5230\u4E86\u8FD8\u6CA1\u6709\u83B7\u53D6\u5230\u9501\uFF0C\u5219\u8FD4\u56DE\u3002</li><li>ReentrantLock \u7684 tryLock() \u65B9\u6CD5<strong>\u53EF\u4EE5\u5C1D\u8BD5\u975E\u963B\u585E\u7684\u83B7\u53D6\u9501</strong>\uFF0C\u8C03\u7528\u8BE5\u65B9\u6CD5\u540E\u7ACB\u523B\u8FD4\u56DE\uFF0C\u5982\u679C\u80FD\u591F\u83B7\u53D6\u5219\u8FD4\u56DEtrue\uFF0C\u5426\u5219\u8FD4\u56DEfalse\u3002</li></ol><h2 id="wait-\u548Csleep-\u7684\u5F02\u540C\u70B9" tabindex="-1"><a class="header-anchor" href="#wait-\u548Csleep-\u7684\u5F02\u540C\u70B9" aria-hidden="true">#</a> wait()\u548Csleep()\u7684\u5F02\u540C\u70B9\uFF1F</h2><p><strong>\u76F8\u540C\u70B9</strong>\uFF1A</p><ol><li>\u5B83\u4EEC\u90FD\u53EF\u4EE5\u4F7F\u5F53\u524D\u7EBF\u7A0B\u6682\u505C\u8FD0\u884C\uFF0C\u628A\u673A\u4F1A\u4EA4\u7ED9\u5176\u4ED6\u7EBF\u7A0B</li><li>\u4EFB\u4F55\u7EBF\u7A0B\u5728\u8C03\u7528wait()\u548Csleep()\u4E4B\u540E\uFF0C\u5728\u7B49\u5F85\u671F\u95F4\u88AB\u4E2D\u65AD\u90FD\u4F1A\u629B\u51FA<code>InterruptedException</code></li></ol><p><strong>\u4E0D\u540C\u70B9</strong>\uFF1A</p><ol><li><code>wait()</code>\u662FObject\u8D85\u7C7B\u4E2D\u7684\u65B9\u6CD5\uFF1B\u800C<code>sleep()</code>\u662F\u7EBF\u7A0BThread\u7C7B\u4E2D\u7684\u65B9\u6CD5</li><li>\u5BF9\u9501\u7684\u6301\u6709\u4E0D\u540C\uFF0C<code>wait()</code>\u4F1A\u91CA\u653E\u9501\uFF0C\u800C<code>sleep()</code>\u5E76\u4E0D\u91CA\u653E\u9501</li><li>\u5524\u9192\u65B9\u6CD5\u4E0D\u5B8C\u5168\u76F8\u540C\uFF0C<code>wait()</code>\u4F9D\u9760<code>notify</code>\u6216\u8005<code>notifyAll </code>\u3001\u4E2D\u65AD\u3001\u8FBE\u5230\u6307\u5B9A\u65F6\u95F4\u6765\u5524\u9192\uFF1B\u800C<code>sleep()</code>\u5230\u8FBE\u6307\u5B9A\u65F6\u95F4\u88AB\u5524\u9192</li><li>\u8C03\u7528<code>wait()</code>\u9700\u8981\u5148\u83B7\u53D6\u5BF9\u8C61\u7684\u9501\uFF0C\u800C<code>Thread.sleep()</code>\u4E0D\u7528</li></ol><h2 id="runnable\u548Ccallable\u6709\u4EC0\u4E48\u533A\u522B" tabindex="-1"><a class="header-anchor" href="#runnable\u548Ccallable\u6709\u4EC0\u4E48\u533A\u522B" aria-hidden="true">#</a> Runnable\u548CCallable\u6709\u4EC0\u4E48\u533A\u522B\uFF1F</h2><ul><li>Callable\u63A5\u53E3\u65B9\u6CD5\u662F<code>call()</code>\uFF0CRunnable\u7684\u65B9\u6CD5\u662F<code>run()</code>\uFF1B</li><li>Callable\u63A5\u53E3call\u65B9\u6CD5\u6709\u8FD4\u56DE\u503C\uFF0C\u652F\u6301\u6CDB\u578B\uFF0CRunnable\u63A5\u53E3run\u65B9\u6CD5\u65E0\u8FD4\u56DE\u503C\u3002</li><li>Callable\u63A5\u53E3<code>call()</code>\u65B9\u6CD5\u5141\u8BB8\u629B\u51FA\u5F02\u5E38\uFF1B\u800CRunnable\u63A5\u53E3<code>run()</code>\u65B9\u6CD5\u4E0D\u80FD\u7EE7\u7EED\u4E0A\u629B\u5F02\u5E38\u3002</li></ul><h2 id="\u7EBF\u7A0B\u6267\u884C\u987A\u5E8F\u600E\u4E48\u63A7\u5236" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u7A0B\u6267\u884C\u987A\u5E8F\u600E\u4E48\u63A7\u5236" aria-hidden="true">#</a> \u7EBF\u7A0B\u6267\u884C\u987A\u5E8F\u600E\u4E48\u63A7\u5236\uFF1F</h2><p>\u5047\u8BBE\u6709T1\u3001T2\u3001T3\u4E09\u4E2A\u7EBF\u7A0B\uFF0C\u4F60\u600E\u6837\u4FDD\u8BC1T2\u5728T1\u6267\u884C\u5B8C\u540E\u6267\u884C\uFF0CT3\u5728T2\u6267\u884C\u5B8C\u540E\u6267\u884C\uFF1F</p><p>\u53EF\u4EE5\u4F7F\u7528<strong>join\u65B9\u6CD5</strong>\u89E3\u51B3\u8FD9\u4E2A\u95EE\u9898\u3002\u6BD4\u5982\u5728\u7EBF\u7A0BA\u4E2D\uFF0C\u8C03\u7528\u7EBF\u7A0BB\u7684join\u65B9\u6CD5\u8868\u793A\u7684\u610F\u601D\u5C31\u662F**\uFF1AA\u7B49\u5F85B\u7EBF\u7A0B\u6267\u884C\u5B8C\u6BD5\u540E\uFF08\u91CA\u653ECPU\u6267\u884C\u6743\uFF09\uFF0C\u5728\u7EE7\u7EED\u6267\u884C\u3002**</p><p>\u4EE3\u7801\u5982\u4E0B\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>public class ThreadTest {

    public static void main(String[] args) {

        Thread spring = new Thread(new SeasonThreadTask(&quot;\u6625\u5929&quot;));
        Thread summer = new Thread(new SeasonThreadTask(&quot;\u590F\u5929&quot;));
        Thread autumn = new Thread(new SeasonThreadTask(&quot;\u79CB\u5929&quot;));

        try
        {
            //\u6625\u5929\u7EBF\u7A0B\u5148\u542F\u52A8
            spring.start();
            //\u4E3B\u7EBF\u7A0B\u7B49\u5F85\u7EBF\u7A0Bspring\u6267\u884C\u5B8C\uFF0C\u518D\u5F80\u4E0B\u6267\u884C
            spring.join();
            //\u590F\u5929\u7EBF\u7A0B\u518D\u542F\u52A8
            summer.start();
            //\u4E3B\u7EBF\u7A0B\u7B49\u5F85\u7EBF\u7A0Bsummer\u6267\u884C\u5B8C\uFF0C\u518D\u5F80\u4E0B\u6267\u884C
            summer.join();
            //\u79CB\u5929\u7EBF\u7A0B\u6700\u540E\u542F\u52A8
            autumn.start();
            //\u4E3B\u7EBF\u7A0B\u7B49\u5F85\u7EBF\u7A0Bautumn\u6267\u884C\u5B8C\uFF0C\u518D\u5F80\u4E0B\u6267\u884C
            autumn.join();
        } catch (InterruptedException e)
        {
            e.printStackTrace();
        }
    }
}

class SeasonThreadTask implements Runnable{

    private String name;

    public SeasonThreadTask(String name){
        this.name = name;
    }

    @Override
    public void run() {
        for (int i = 1; i &lt;4; i++) {
            System.out.println(this.name + &quot;\u6765\u4E86: &quot; + i + &quot;\u6B21&quot;);
            try {
                Thread.sleep(100);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
    }
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD0\u884C\u7ED3\u679C\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>\u6625\u5929\u6765\u4E86: 1\u6B21
\u6625\u5929\u6765\u4E86: 2\u6B21
\u6625\u5929\u6765\u4E86: 3\u6B21
\u590F\u5929\u6765\u4E86: 1\u6B21
\u590F\u5929\u6765\u4E86: 2\u6B21
\u590F\u5929\u6765\u4E86: 3\u6B21
\u79CB\u5929\u6765\u4E86: 1\u6B21
\u79CB\u5929\u6765\u4E86: 2\u6B21
\u79CB\u5929\u6765\u4E86: 3\u6B21
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u5B88\u62A4\u7EBF\u7A0B\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#\u5B88\u62A4\u7EBF\u7A0B\u662F\u4EC0\u4E48" aria-hidden="true">#</a> \u5B88\u62A4\u7EBF\u7A0B\u662F\u4EC0\u4E48\uFF1F</h2><p>\u5B88\u62A4\u7EBF\u7A0B\u662F<strong>\u8FD0\u884C\u5728\u540E\u53F0\u7684\u4E00\u79CD\u7279\u6B8A\u8FDB\u7A0B</strong>\u3002\u5B83\u72EC\u7ACB\u4E8E\u63A7\u5236\u7EC8\u7AEF\u5E76\u4E14\u5468\u671F\u6027\u5730\u6267\u884C\u67D0\u79CD\u4EFB\u52A1\u6216\u7B49\u5F85\u5904\u7406\u67D0\u4E9B\u53D1\u751F\u7684\u4E8B\u4EF6\u3002\u5728 Java \u4E2D\u5783\u573E\u56DE\u6536\u7EBF\u7A0B\u5C31\u662F\u7279\u6B8A\u7684\u5B88\u62A4\u7EBF\u7A0B\u3002</p><h2 id="\u7EBF\u7A0B\u95F4\u901A\u4FE1\u65B9\u5F0F" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u7A0B\u95F4\u901A\u4FE1\u65B9\u5F0F" aria-hidden="true">#</a> \u7EBF\u7A0B\u95F4\u901A\u4FE1\u65B9\u5F0F</h2><p><strong>volatile</strong></p><p><strong>volatile</strong> \u4F7F\u7528\u5171\u4EAB\u5185\u5B58\u5B9E\u73B0\u7EBF\u7A0B\u95F4\u76F8\u4E92\u901A\u4FE1\u3002\u591A\u4E2A\u7EBF\u7A0B\u540C\u65F6\u76D1\u542C\u4E00\u4E2A\u53D8\u91CF\uFF0C\u5F53\u8FD9\u4E2A\u53D8\u91CF\u88AB\u67D0\u4E00\u4E2A\u7EBF\u7A0B\u4FEE\u6539\u7684\u65F6\u5019\uFF0C\u5176\u4ED6\u7EBF\u7A0B\u53EF\u4EE5\u611F\u77E5\u5230\u8FD9\u4E2A\u53D8\u5316\u3002</p><p><strong>wait \u548C notify</strong></p><p><code>wait/notify</code>\u4E3AObject\u5BF9\u8C61\u7684\u65B9\u6CD5\uFF0C\u8C03\u7528<code>wait/notify</code>\u9700\u8981\u5148\u83B7\u5F97\u5BF9\u8C61\u7684\u9501\u3002\u5BF9\u8C61\u8C03\u7528<code>wait()</code>\u4E4B\u540E\u7EBF\u7A0B\u91CA\u653E\u9501\uFF0C\u5C06\u7EBF\u7A0B\u653E\u5230\u5BF9\u8C61\u7684\u7B49\u5F85\u961F\u5217\uFF0C\u5F53\u901A\u77E5\u7EBF\u7A0B\u8C03\u7528\u6B64\u5BF9\u8C61\u7684<code>notify()</code>\u65B9\u6CD5\u540E\uFF0C\u7B49\u5F85\u7EBF\u7A0B\u5E76\u4E0D\u4F1A\u7ACB\u5373\u4ECE<code>wait()</code>\u8FD4\u56DE\uFF0C\u9700\u8981\u7B49\u5F85\u901A\u77E5\u7EBF\u7A0B\u91CA\u653E\u9501\uFF08\u901A\u77E5\u7EBF\u7A0B\u6267\u884C\u5B8C\u540C\u6B65\u4EE3\u7801\u5757\uFF09\uFF0C\u7B49\u5F85\u961F\u5217\u91CC\u7684\u7EBF\u7A0B\u83B7\u53D6\u9501\uFF0C\u83B7\u53D6\u9501\u6210\u529F\u624D\u80FD\u4ECE<code>wait()</code>\u65B9\u6CD5\u8FD4\u56DE\uFF0C\u5373\u4ECE<code>wait()</code>\u65B9\u6CD5\u8FD4\u56DE\u524D\u63D0\u662F\u7EBF\u7A0B\u83B7\u5F97\u9501\u3002</p><p><strong>join</strong></p><p>\u5F53\u5728\u4E00\u4E2A\u7EBF\u7A0B\u8C03\u7528\u53E6\u4E00\u4E2A\u7EBF\u7A0B\u7684<code>join()</code>\u65B9\u6CD5\u65F6\uFF0C\u5F53\u524D\u7EBF\u7A0B\u963B\u585E\u7B49\u5F85\u88AB\u8C03\u7528join\u65B9\u6CD5\u7684\u7EBF\u7A0B\u6267\u884C\u5B8C\u6BD5\u624D\u80FD\u7EE7\u7EED\u6267\u884C\u3002<code>join()</code>\u662F\u57FA\u4E8E\u7B49\u5F85\u901A\u77E5\u673A\u5236\u5B9E\u73B0\u7684\u3002</p><h2 id="threadlocal" tabindex="-1"><a class="header-anchor" href="#threadlocal" aria-hidden="true">#</a> ThreadLocal</h2><p>\u7EBF\u7A0B\u672C\u5730\u53D8\u91CF\u3002\u5F53\u4F7F\u7528<code>ThreadLocal</code>\u7EF4\u62A4\u53D8\u91CF\u65F6\uFF0C<code>ThreadLocal</code>\u4E3A\u6BCF\u4E2A\u4F7F\u7528\u8BE5\u53D8\u91CF\u7684\u7EBF\u7A0B\u63D0\u4F9B\u72EC\u7ACB\u7684\u53D8\u91CF\u526F\u672C\uFF0C\u6240\u4EE5\u6BCF\u4E00\u4E2A\u7EBF\u7A0B\u90FD\u53EF\u4EE5\u72EC\u7ACB\u5730\u6539\u53D8\u81EA\u5DF1\u7684\u526F\u672C\uFF0C\u800C\u4E0D\u4F1A\u5F71\u54CD\u5176\u5B83\u7EBF\u7A0B\u3002</p><h3 id="threadlocal\u539F\u7406" tabindex="-1"><a class="header-anchor" href="#threadlocal\u539F\u7406" aria-hidden="true">#</a> ThreadLocal\u539F\u7406</h3><p>\u6BCF\u4E2A\u7EBF\u7A0B\u90FD\u6709\u4E00\u4E2A<code>ThreadLocalMap</code>\uFF08<code>ThreadLocal</code>\u5185\u90E8\u7C7B\uFF09\uFF0CMap\u4E2D\u5143\u7D20\u7684\u952E\u4E3A<code>ThreadLocal</code>\uFF0C\u800C\u503C\u5BF9\u5E94\u7EBF\u7A0B\u7684\u53D8\u91CF\u526F\u672C\u3002</p><p><img src="http://img.dabin-coder.cn/image/threadlocal.png" alt="" loading="lazy"></p><p>\u8C03\u7528<code>threadLocal.set()</code>--&gt;\u8C03\u7528<code>getMap(Thread)</code>--&gt;\u8FD4\u56DE\u5F53\u524D\u7EBF\u7A0B\u7684<code>ThreadLocalMap&lt;ThreadLocal, value&gt;</code>--&gt;<code>map.set(this, value)</code>\uFF0Cthis\u662F<code>threadLocal</code>\u672C\u8EAB\u3002\u6E90\u7801\u5982\u4E0B\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">T</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Thread</span> t <span class="token operator">=</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">ThreadLocalMap</span> map <span class="token operator">=</span> <span class="token function">getMap</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>map <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
        map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
        <span class="token function">createMap</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">ThreadLocalMap</span> <span class="token function">getMap</span><span class="token punctuation">(</span><span class="token class-name">Thread</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> t<span class="token punctuation">.</span>threadLocals<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">createMap</span><span class="token punctuation">(</span><span class="token class-name">Thread</span> t<span class="token punctuation">,</span> <span class="token class-name">T</span> firstValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    t<span class="token punctuation">.</span>threadLocals <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadLocalMap</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> firstValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8C03\u7528<code>get()</code>--&gt;\u8C03\u7528<code>getMap(Thread)</code>--&gt;\u8FD4\u56DE\u5F53\u524D\u7EBF\u7A0B\u7684<code>ThreadLocalMap&lt;ThreadLocal, value&gt;</code>--&gt;<code>map.getEntry(this)</code>\uFF0C\u8FD4\u56DE<code>value</code>\u3002\u6E90\u7801\u5982\u4E0B\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token class-name">T</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Thread</span> t <span class="token operator">=</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ThreadLocalMap</span> map <span class="token operator">=</span> <span class="token function">getMap</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>map <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">ThreadLocalMap<span class="token punctuation">.</span>Entry</span> e <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">getEntry</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">&quot;unchecked&quot;</span><span class="token punctuation">)</span>
                <span class="token class-name">T</span> result <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span>e<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
                <span class="token keyword">return</span> result<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token function">setInitialValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>threadLocals</code>\u7684\u7C7B\u578B<code>ThreadLocalMap</code>\u7684\u952E\u4E3A<code>ThreadLocal</code>\u5BF9\u8C61\uFF0C\u56E0\u4E3A\u6BCF\u4E2A\u7EBF\u7A0B\u4E2D\u53EF\u6709\u591A\u4E2A<code>threadLocal</code>\u53D8\u91CF\uFF0C\u5982<code>longLocal</code>\u548C<code>stringLocal</code>\u3002</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>public class ThreadLocalDemo {
    ThreadLocal&lt;Long&gt; longLocal = new ThreadLocal&lt;&gt;();

    public void set() {
        longLocal.set(Thread.currentThread().getId());
    }
    public Long get() {
        return longLocal.get();
    }

    public static void main(String[] args) throws InterruptedException {
        ThreadLocalDemo threadLocalDemo = new ThreadLocalDemo();
        threadLocalDemo.set();
        System.out.println(threadLocalDemo.get());

        Thread thread = new Thread(() -&gt; {
            threadLocalDemo.set();
            System.out.println(threadLocalDemo.get());
        }
        );

        thread.start();
        thread.join();

        System.out.println(threadLocalDemo.get());
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>ThreadLocal</code>\u5E76\u4E0D\u662F\u7528\u6765\u89E3\u51B3\u5171\u4EAB\u8D44\u6E90\u7684\u591A\u7EBF\u7A0B\u8BBF\u95EE\u95EE\u9898\uFF0C\u56E0\u4E3A\u6BCF\u4E2A\u7EBF\u7A0B\u4E2D\u7684\u8D44\u6E90\u53EA\u662F\u526F\u672C\uFF0C\u4E0D\u4F1A\u5171\u4EAB\u3002\u56E0\u6B64<code>ThreadLocal</code>\u9002\u5408\u4F5C\u4E3A\u7EBF\u7A0B\u4E0A\u4E0B\u6587\u53D8\u91CF\uFF0C\u7B80\u5316\u7EBF\u7A0B\u5185\u4F20\u53C2\u3002</p><h3 id="threadlocal\u5185\u5B58\u6CC4\u6F0F\u7684\u539F\u56E0" tabindex="-1"><a class="header-anchor" href="#threadlocal\u5185\u5B58\u6CC4\u6F0F\u7684\u539F\u56E0" aria-hidden="true">#</a> ThreadLocal\u5185\u5B58\u6CC4\u6F0F\u7684\u539F\u56E0\uFF1F</h3><p>\u6BCF\u4E2A\u7EBF\u7A0B\u90FD\u6709\u2F00\u4E2A<code>ThreadLocalMap</code>\u7684\u5185\u90E8\u5C5E\u6027\uFF0Cmap\u7684key\u662F<code>ThreaLocal</code>\uFF0C\u5B9A\u4E49\u4E3A\u5F31\u5F15\u7528\uFF0Cvalue\u662F\u5F3A\u5F15\u7528\u7C7B\u578B\u3002\u5783\u573E\u56DE\u6536\u7684\u65F6\u5019\u4F1A\u2F83\u52A8\u56DE\u6536key\uFF0C\u800Cvalue\u7684\u56DE\u6536\u53D6\u51B3\u4E8EThread\u5BF9\u8C61\u7684\u751F\u547D\u5468\u671F\u3002\u4E00\u822C\u4F1A\u901A\u8FC7\u7EBF\u7A0B\u6C60\u7684\u65B9\u5F0F\u590D\u7528\u7EBF\u7A0B\u8282\u7701\u8D44\u6E90\uFF0C\u8FD9\u4E5F\u5C31\u5BFC\u81F4\u4E86\u7EBF\u7A0B\u5BF9\u8C61\u7684\u751F\u547D\u5468\u671F\u6BD4\u8F83\u957F\uFF0C\u8FD9\u6837\u4FBF\u4E00\u76F4\u5B58\u5728\u4E00\u6761\u5F3A\u5F15\u7528\u94FE\u7684\u5173\u7CFB\uFF1A<code>Thread</code> --&gt; <code>ThreadLocalMap</code>--&gt;<code>Entry</code>--&gt;<code>Value</code>\uFF0C\u968F\u7740\u4EFB\u52A1\u7684\u6267\u884C\uFF0Cvalue\u5C31\u6709\u53EF\u80FD\u8D8A\u6765\u8D8A\u591A\u4E14\u65E0\u6CD5\u91CA\u653E\uFF0C\u6700\u7EC8\u5BFC\u81F4\u5185\u5B58\u6CC4\u6F0F\u3002</p><p>\u89E3\u51B3\u2F45\u6CD5\uFF1A\u6BCF\u6B21\u4F7F\u2F64\u5B8C<code>ThreadLocal</code>\u5C31\u8C03\u2F64\u5B83\u7684<code>remove()</code>\u2F45\u6CD5\uFF0C\u624B\u52A8\u5C06\u5BF9\u5E94\u7684\u952E\u503C\u5BF9\u5220\u9664\uFF0C\u4ECE\u2F7D\u907F\u514D\u5185\u5B58\u6CC4\u6F0F\u3002</p><h3 id="threadlocal\u4F7F\u7528\u573A\u666F\u6709\u54EA\u4E9B" tabindex="-1"><a class="header-anchor" href="#threadlocal\u4F7F\u7528\u573A\u666F\u6709\u54EA\u4E9B" aria-hidden="true">#</a> ThreadLocal\u4F7F\u7528\u573A\u666F\u6709\u54EA\u4E9B\uFF1F</h3><p><strong>\u573A\u666F1</strong></p><p>ThreadLocal \u7528\u4F5C\u4FDD\u5B58\u6BCF\u4E2A\u7EBF\u7A0B\u72EC\u4EAB\u7684\u5BF9\u8C61\uFF0C\u4E3A\u6BCF\u4E2A\u7EBF\u7A0B\u90FD\u521B\u5EFA\u4E00\u4E2A\u526F\u672C\uFF0C\u8FD9\u6837\u6BCF\u4E2A\u7EBF\u7A0B\u90FD\u53EF\u4EE5\u4FEE\u6539\u81EA\u5DF1\u6240\u62E5\u6709\u7684\u526F\u672C, \u800C\u4E0D\u4F1A\u5F71\u54CD\u5176\u4ED6\u7EBF\u7A0B\u7684\u526F\u672C\uFF0C\u786E\u4FDD\u4E86\u7EBF\u7A0B\u5B89\u5168\u3002</p><p>\u8FD9\u79CD\u573A\u666F\u901A\u5E38\u7528\u4E8E\u4FDD\u5B58\u7EBF\u7A0B\u4E0D\u5B89\u5168\u7684\u5DE5\u5177\u7C7B\uFF0C\u5178\u578B\u7684\u4F7F\u7528\u7684\u7C7B\u5C31\u662F SimpleDateFormat\u3002</p><p>\u5047\u5982\u9700\u6C42\u4E3A500\u4E2A\u7EBF\u7A0B\u90FD\u8981\u7528\u5230 SimpleDateFormat\uFF0C\u4F7F\u7528\u7EBF\u7A0B\u6C60\u6765\u5B9E\u73B0\u7EBF\u7A0B\u7684\u590D\u7528\uFF0C\u5426\u5219\u4F1A\u6D88\u8017\u8FC7\u591A\u7684\u5185\u5B58\u7B49\u8D44\u6E90\uFF0C\u5982\u679C\u6211\u4EEC\u6BCF\u4E2A\u4EFB\u52A1\u90FD\u521B\u5EFA\u4E86\u4E00\u4E2A simpleDateFormat \u5BF9\u8C61\uFF0C\u4E5F\u5C31\u662F\u8BF4\uFF0C500\u4E2A\u4EFB\u52A1\u5BF9\u5E94500\u4E2A simpleDateFormat \u5BF9\u8C61\u3002\u4F46\u662F\u8FD9\u4E48\u591A\u5BF9\u8C61\u7684\u521B\u5EFA\u662F\u6709\u5F00\u9500\u7684\uFF0C\u800C\u4E14\u8FD9\u4E48\u591A\u5BF9\u8C61\u540C\u65F6\u5B58\u5728\u5728\u5185\u5B58\u4E2D\u4E5F\u662F\u4E00\u79CD\u5185\u5B58\u7684\u6D6A\u8D39\u3002\u53EF\u4EE5\u5C06simpleDateFormat \u5BF9\u8C61\u7ED9\u63D0\u53D6\u4E86\u51FA\u6765\uFF0C\u53D8\u6210\u9759\u6001\u53D8\u91CF\uFF0C\u4F46\u662F\u8FD9\u6837\u4E00\u6765\u5C31\u4F1A\u6709\u7EBF\u7A0B\u4E0D\u5B89\u5168\u7684\u95EE\u9898\u3002\u6211\u4EEC\u60F3\u8981\u7684\u6548\u679C\u662F\uFF0C\u65E2\u4E0D\u6D6A\u8D39\u8FC7\u591A\u7684\u5185\u5B58\uFF0C\u540C\u65F6\u53C8\u60F3\u4FDD\u8BC1\u7EBF\u7A0B\u5B89\u5168\u3002\u6B64\u65F6\uFF0C\u53EF\u4EE5\u4F7F\u7528 ThreadLocal\u6765\u8FBE\u5230\u8FD9\u4E2A\u76EE\u7684\uFF0C\u6BCF\u4E2A\u7EBF\u7A0B\u90FD\u62E5\u6709\u4E00\u4E2A\u81EA\u5DF1\u7684 simpleDateFormat \u5BF9\u8C61\u3002</p><p><strong>\u573A\u666F2</strong></p><p>ThreadLocal \u7528\u4F5C\u6BCF\u4E2A\u7EBF\u7A0B\u5185\u9700\u8981\u72EC\u7ACB\u4FDD\u5B58\u4FE1\u606F\uFF0C\u4EE5\u4FBF\u4F9B\u5176\u4ED6\u65B9\u6CD5\u66F4\u65B9\u4FBF\u5730\u83B7\u53D6\u8BE5\u4FE1\u606F\u7684\u573A\u666F\u3002\u6BCF\u4E2A\u7EBF\u7A0B\u83B7\u53D6\u5230\u7684\u4FE1\u606F\u53EF\u80FD\u90FD\u662F\u4E0D\u4E00\u6837\u7684\uFF0C\u524D\u9762\u6267\u884C\u7684\u65B9\u6CD5\u4FDD\u5B58\u4E86\u4FE1\u606F\u540E\uFF0C\u540E\u7EED\u65B9\u6CD5\u53EF\u4EE5\u901A\u8FC7 ThreadLocal \u76F4\u63A5\u83B7\u53D6\u5230\uFF0C\u907F\u514D\u4E86\u4F20\u53C2\uFF0C\u7C7B\u4F3C\u4E8E\u5168\u5C40\u53D8\u91CF\u7684\u6982\u5FF5\u3002</p><p>\u6BD4\u5982Java web\u5E94\u7528\u4E2D\uFF0C\u6BCF\u4E2A\u7EBF\u7A0B\u6709\u81EA\u5DF1\u5355\u72EC\u7684<code>Session</code>\u5B9E\u4F8B\uFF0C\u5C31\u53EF\u4EE5\u4F7F\u7528<code>ThreadLocal</code>\u6765\u5B9E\u73B0\u3002</p><h2 id="aqs\u539F\u7406" tabindex="-1"><a class="header-anchor" href="#aqs\u539F\u7406" aria-hidden="true">#</a> AQS\u539F\u7406</h2><p>AQS\uFF0C<code>AbstractQueuedSynchronizer</code>\uFF0C\u62BD\u8C61\u961F\u5217\u540C\u6B65\u5668\uFF0C\u5B9A\u4E49\u4E86\u4E00\u5957\u591A\u7EBF\u7A0B\u8BBF\u95EE\u5171\u4EAB\u8D44\u6E90\u7684\u540C\u6B65\u5668\u6846\u67B6\uFF0C\u8BB8\u591A\u5E76\u53D1\u5DE5\u5177\u7684\u5B9E\u73B0\u90FD\u4F9D\u8D56\u4E8E\u5B83\uFF0C\u5982\u5E38\u7528\u7684<code>ReentrantLock/Semaphore/CountDownLatch</code>\u3002</p><p>AQS\u4F7F\u7528\u4E00\u4E2A<code>volatile</code>\u7684int\u7C7B\u578B\u7684\u6210\u5458\u53D8\u91CF<code>state</code>\u6765\u8868\u793A\u540C\u6B65\u72B6\u6001\uFF0C\u901A\u8FC7CAS\u4FEE\u6539\u540C\u6B65\u72B6\u6001\u7684\u503C\u3002\u5F53\u7EBF\u7A0B\u8C03\u7528 lock \u65B9\u6CD5\u65F6 \uFF0C\u5982\u679C <code>state</code>=0\uFF0C\u8BF4\u660E\u6CA1\u6709\u4EFB\u4F55\u7EBF\u7A0B\u5360\u6709\u5171\u4EAB\u8D44\u6E90\u7684\u9501\uFF0C\u53EF\u4EE5\u83B7\u5F97\u9501\u5E76\u5C06 <code>state</code>\u52A01\u3002\u5982\u679C <code>state</code>\u4E0D\u4E3A0\uFF0C\u5219\u8BF4\u660E\u6709\u7EBF\u7A0B\u76EE\u524D\u6B63\u5728\u4F7F\u7528\u5171\u4EAB\u53D8\u91CF\uFF0C\u5176\u4ED6\u7EBF\u7A0B\u5FC5\u987B\u52A0\u5165\u540C\u6B65\u961F\u5217\u8FDB\u884C\u7B49\u5F85\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">volatile</span> <span class="token keyword">int</span> state<span class="token punctuation">;</span><span class="token comment">//\u5171\u4EAB\u53D8\u91CF\uFF0C\u4F7F\u7528volatile\u4FEE\u9970\u4FDD\u8BC1\u7EBF\u7A0B\u53EF\u89C1\u6027</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u540C\u6B65\u5668\u4F9D\u8D56\u5185\u90E8\u7684\u540C\u6B65\u961F\u5217\uFF08\u4E00\u4E2AFIFO\u53CC\u5411\u961F\u5217\uFF09\u6765\u5B8C\u6210\u540C\u6B65\u72B6\u6001\u7684\u7BA1\u7406\uFF0C\u5F53\u524D\u7EBF\u7A0B\u83B7\u53D6\u540C\u6B65\u72B6\u6001\u5931\u8D25\u65F6\uFF0C\u540C\u6B65\u5668\u4F1A\u5C06\u5F53\u524D\u7EBF\u7A0B\u4EE5\u53CA\u7B49\u5F85\u72B6\u6001\uFF08\u72EC\u5360\u6216\u5171\u4EAB \uFF09\u6784\u9020\u6210\u4E3A\u4E00\u4E2A\u8282\u70B9\uFF08Node\uFF09\u5E76\u5C06\u5176\u52A0\u5165\u540C\u6B65\u961F\u5217\u5E76\u8FDB\u884C\u81EA\u65CB\uFF0C\u5F53\u540C\u6B65\u72B6\u6001\u91CA\u653E\u65F6\uFF0C\u4F1A\u628A\u9996\u8282\u70B9\u4E2D\u7684\u540E\u7EE7\u8282\u70B9\u5BF9\u5E94\u7684\u7EBF\u7A0B\u5524\u9192\uFF0C\u4F7F\u5176\u518D\u6B21\u5C1D\u8BD5\u83B7\u53D6\u540C\u6B65\u72B6\u6001\u3002</p><p><img src="http://img.dabin-coder.cn/image/aqs.png" alt="" loading="lazy"></p><h2 id="reentrantlock-\u662F\u5982\u4F55\u5B9E\u73B0\u53EF\u91CD\u5165\u6027\u7684" tabindex="-1"><a class="header-anchor" href="#reentrantlock-\u662F\u5982\u4F55\u5B9E\u73B0\u53EF\u91CD\u5165\u6027\u7684" aria-hidden="true">#</a> ReentrantLock \u662F\u5982\u4F55\u5B9E\u73B0\u53EF\u91CD\u5165\u6027\u7684?</h2><p><code>ReentrantLock</code>\u5185\u90E8\u81EA\u5B9A\u4E49\u4E86\u540C\u6B65\u5668sync\uFF0C\u5728\u52A0\u9501\u7684\u65F6\u5019\u901A\u8FC7CAS\u7B97\u6CD5\uFF0C\u5C06\u7EBF\u7A0B\u5BF9\u8C61\u653E\u5230\u4E00\u4E2A\u53CC\u5411\u94FE\u8868\u4E2D\uFF0C\u6BCF\u6B21\u83B7\u53D6\u9501\u7684\u65F6\u5019\uFF0C\u68C0\u67E5\u5F53\u524D\u7EF4\u62A4\u7684\u90A3\u4E2A\u7EBF\u7A0BID\u548C\u5F53\u524D\u8BF7\u6C42\u7684\u7EBF\u7A0BID\u662F\u5426 \u4E00\u81F4\uFF0C\u5982\u679C\u4E00\u81F4\uFF0C\u540C\u6B65\u72B6\u6001\u52A01\uFF0C\u8868\u793A\u9501\u88AB\u5F53\u524D\u7EBF\u7A0B\u83B7\u53D6\u4E86\u591A\u6B21\u3002</p><p>\u6E90\u7801\u5982\u4E0B\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token function">nonfairTryAcquire</span><span class="token punctuation">(</span><span class="token keyword">int</span> acquires<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">final</span> <span class="token class-name">Thread</span> current <span class="token operator">=</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> c <span class="token operator">=</span> <span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">compareAndSetState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> acquires<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">setExclusiveOwnerThread</span><span class="token punctuation">(</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>current <span class="token operator">==</span> <span class="token function">getExclusiveOwnerThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> nextc <span class="token operator">=</span> c <span class="token operator">+</span> acquires<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>nextc <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// overflow</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;Maximum lock count exceeded&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setState</span><span class="token punctuation">(</span>nextc<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u9501\u7684\u5206\u7C7B" tabindex="-1"><a class="header-anchor" href="#\u9501\u7684\u5206\u7C7B" aria-hidden="true">#</a> \u9501\u7684\u5206\u7C7B</h2><h3 id="\u516C\u5E73\u9501\u4E0E\u975E\u516C\u5E73\u9501" tabindex="-1"><a class="header-anchor" href="#\u516C\u5E73\u9501\u4E0E\u975E\u516C\u5E73\u9501" aria-hidden="true">#</a> \u516C\u5E73\u9501\u4E0E\u975E\u516C\u5E73\u9501</h3><p>\u6309\u7167<strong>\u7EBF\u7A0B\u8BBF\u95EE\u987A\u5E8F</strong>\u83B7\u53D6\u5BF9\u8C61\u9501\u3002<code>synchronized</code>\u662F\u975E\u516C\u5E73\u9501\uFF0C<code>Lock</code>\u9ED8\u8BA4\u662F\u975E\u516C\u5E73\u9501\uFF0C\u53EF\u4EE5\u8BBE\u7F6E\u4E3A\u516C\u5E73\u9501\uFF0C\u516C\u5E73\u9501\u4F1A\u5F71\u54CD\u6027\u80FD\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    sync <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NonfairSync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> fair<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    sync <span class="token operator">=</span> fair <span class="token operator">?</span> <span class="token keyword">new</span> <span class="token class-name">FairSync</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">NonfairSync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u5171\u4EAB\u5F0F\u4E0E\u72EC\u5360\u5F0F\u9501" tabindex="-1"><a class="header-anchor" href="#\u5171\u4EAB\u5F0F\u4E0E\u72EC\u5360\u5F0F\u9501" aria-hidden="true">#</a> \u5171\u4EAB\u5F0F\u4E0E\u72EC\u5360\u5F0F\u9501</h3><p>\u5171\u4EAB\u5F0F\u4E0E\u72EC\u5360\u5F0F\u7684\u6700\u4E3B\u8981<strong>\u533A\u522B</strong>\u5728\u4E8E\uFF1A\u540C\u4E00\u65F6\u523B\u72EC\u5360\u5F0F\u53EA\u80FD\u6709<strong>\u4E00\u4E2A\u7EBF\u7A0B</strong>\u83B7\u53D6\u540C\u6B65\u72B6\u6001\uFF0C\u800C\u5171\u4EAB\u5F0F\u5728\u540C\u4E00\u65F6\u523B\u53EF\u4EE5\u6709\u591A\u4E2A\u7EBF\u7A0B\u83B7\u53D6\u540C\u6B65\u72B6\u6001\u3002\u4F8B\u5982\u8BFB\u64CD\u4F5C\u53EF\u4EE5\u6709\u591A\u4E2A\u7EBF\u7A0B\u540C\u65F6\u8FDB\u884C\uFF0C\u800C\u5199\u64CD\u4F5C\u540C\u4E00\u65F6\u523B\u53EA\u80FD\u6709\u4E00\u4E2A\u7EBF\u7A0B\u8FDB\u884C\u5199\u64CD\u4F5C\uFF0C\u5176\u4ED6\u64CD\u4F5C\u90FD\u4F1A\u88AB\u963B\u585E\u3002</p><h3 id="\u60B2\u89C2\u9501\u4E0E\u4E50\u89C2\u9501" tabindex="-1"><a class="header-anchor" href="#\u60B2\u89C2\u9501\u4E0E\u4E50\u89C2\u9501" aria-hidden="true">#</a> \u60B2\u89C2\u9501\u4E0E\u4E50\u89C2\u9501</h3><p>\u60B2\u89C2\u9501\uFF0C<strong>\u6BCF\u6B21\u8BBF\u95EE\u8D44\u6E90\u90FD\u4F1A\u52A0\u9501</strong>\uFF0C\u6267\u884C\u5B8C\u540C\u6B65\u4EE3\u7801\u91CA\u653E\u9501\uFF0C<code>synchronized</code>\u548C<code>ReentrantLock</code>\u5C5E\u4E8E\u60B2\u89C2\u9501\u3002</p><p>\u4E50\u89C2\u9501\uFF0C\u4E0D\u4F1A\u9501\u5B9A\u8D44\u6E90\uFF0C\u6240\u6709\u7684\u7EBF\u7A0B\u90FD\u80FD\u8BBF\u95EE\u5E76\u4FEE\u6539\u540C\u4E00\u4E2A\u8D44\u6E90\uFF0C\u5982\u679C\u6CA1\u6709\u51B2\u7A81\u5C31\u4FEE\u6539\u6210\u529F\u5E76\u9000\u51FA\uFF0C\u5426\u5219\u5C31\u4F1A\u7EE7\u7EED\u5FAA\u73AF\u5C1D\u8BD5\u3002\u4E50\u89C2\u9501\u6700\u5E38\u89C1\u7684\u5B9E\u73B0\u5C31\u662F<code>CAS</code>\u3002</p><p>\u9002\u7528\u573A\u666F\uFF1A</p><ul><li>\u60B2\u89C2\u9501\u9002\u5408<strong>\u5199\u64CD\u4F5C\u591A</strong>\u7684\u573A\u666F\u3002</li><li>\u4E50\u89C2\u9501\u9002\u5408<strong>\u8BFB\u64CD\u4F5C\u591A</strong>\u7684\u573A\u666F\uFF0C\u4E0D\u52A0\u9501\u53EF\u4EE5\u63D0\u5347\u8BFB\u64CD\u4F5C\u7684\u6027\u80FD\u3002</li></ul><h2 id="\u4E50\u89C2\u9501\u6709\u4EC0\u4E48\u95EE\u9898" tabindex="-1"><a class="header-anchor" href="#\u4E50\u89C2\u9501\u6709\u4EC0\u4E48\u95EE\u9898" aria-hidden="true">#</a> \u4E50\u89C2\u9501\u6709\u4EC0\u4E48\u95EE\u9898?</h2><p>\u4E50\u89C2\u9501\u907F\u514D\u4E86\u60B2\u89C2\u9501\u72EC\u5360\u5BF9\u8C61\u7684\u95EE\u9898\uFF0C\u63D0\u9AD8\u4E86\u5E76\u53D1\u6027\u80FD\uFF0C\u4F46\u5B83\u4E5F\u6709\u7F3A\u70B9:</p><ul><li>\u4E50\u89C2\u9501\u53EA\u80FD\u4FDD\u8BC1<strong>\u4E00\u4E2A\u5171\u4EAB\u53D8\u91CF</strong>\u7684\u539F\u5B50\u64CD\u4F5C\u3002</li><li>\u957F\u65F6\u95F4\u81EA\u65CB\u53EF\u80FD\u5BFC\u81F4<strong>\u5F00\u9500\u5927</strong>\u3002\u5047\u5982CAS\u957F\u65F6\u95F4\u4E0D\u6210\u529F\u800C\u4E00\u76F4\u81EA\u65CB\uFF0C\u4F1A\u7ED9CPU\u5E26\u6765\u5F88\u5927\u7684\u5F00\u9500\u3002</li><li><strong>ABA\u95EE\u9898</strong>\u3002CAS\u7684\u539F\u7406\u662F\u901A\u8FC7\u6BD4\u5BF9\u5185\u5B58\u503C\u4E0E\u9884\u671F\u503C\u662F\u5426\u4E00\u6837\u800C\u5224\u65AD\u5185\u5B58\u503C\u662F\u5426\u88AB\u6539\u8FC7\uFF0C\u4F46\u662F\u4F1A\u6709\u4EE5\u4E0B\u95EE\u9898\uFF1A\u5047\u5982\u5185\u5B58\u503C\u539F\u6765\u662FA\uFF0C \u540E\u6765\u88AB\u4E00\u6761\u7EBF\u7A0B\u6539\u4E3AB\uFF0C\u6700\u540E\u53C8\u88AB\u6539\u6210\u4E86A\uFF0C\u5219CAS\u8BA4\u4E3A\u6B64\u5185\u5B58\u503C\u5E76\u6CA1\u6709\u53D1\u751F\u6539\u53D8\u3002\u53EF\u4EE5\u5F15\u5165\u7248\u672C\u53F7\u89E3\u51B3\u8FD9\u4E2A\u95EE\u9898\uFF0C\u6BCF\u6B21\u53D8\u91CF\u66F4\u65B0\u90FD\u628A\u7248\u672C\u53F7\u52A0\u4E00\u3002</li></ul><h2 id="\u4EC0\u4E48\u662Fcas" tabindex="-1"><a class="header-anchor" href="#\u4EC0\u4E48\u662Fcas" aria-hidden="true">#</a> \u4EC0\u4E48\u662FCAS\uFF1F</h2><p>CAS\u5168\u79F0<code>Compare And Swap</code>\uFF0C\u6BD4\u8F83\u4E0E\u4EA4\u6362\uFF0C\u662F\u4E50\u89C2\u9501\u7684\u4E3B\u8981\u5B9E\u73B0\u65B9\u5F0F\u3002CAS\u5728\u4E0D\u4F7F\u7528\u9501\u7684\u60C5\u51B5\u4E0B\u5B9E\u73B0\u591A\u7EBF\u7A0B\u4E4B\u95F4\u7684\u53D8\u91CF\u540C\u6B65\u3002<code>ReentrantLock</code>\u5185\u90E8\u7684AQS\u548C\u539F\u5B50\u7C7B\u5185\u90E8\u90FD\u4F7F\u7528\u4E86CAS\u3002</p><p>CAS\u7B97\u6CD5\u6D89\u53CA\u5230\u4E09\u4E2A\u64CD\u4F5C\u6570\uFF1A</p><ul><li>\u9700\u8981\u8BFB\u5199\u7684\u5185\u5B58\u503CV\u3002</li><li>\u8FDB\u884C\u6BD4\u8F83\u7684\u503CA\u3002</li><li>\u8981\u5199\u5165\u7684\u65B0\u503CB\u3002</li></ul><p>\u53EA\u6709\u5F53V\u7684\u503C\u7B49\u4E8EA\u65F6\uFF0C\u624D\u4F1A\u4F7F\u7528\u539F\u5B50\u65B9\u5F0F\u7528\u65B0\u503CB\u6765\u66F4\u65B0V\u7684\u503C\uFF0C\u5426\u5219\u4F1A\u7EE7\u7EED\u91CD\u8BD5\u76F4\u5230\u6210\u529F\u66F4\u65B0\u503C\u3002</p><p>\u4EE5<code>AtomicInteger</code>\u4E3A\u4F8B\uFF0C<code>AtomicInteger</code>\u7684<code>getAndIncrement()</code>\u65B9\u6CD5\u5E95\u5C42\u5C31\u662FCAS\u5B9E\u73B0\uFF0C\u5173\u952E\u4EE3\u7801\u662F <code>compareAndSwapInt(obj, offset, expect, update)</code>\uFF0C\u5176\u542B\u4E49\u5C31\u662F\uFF0C\u5982\u679C<code>obj</code>\u5185\u7684<code>value</code>\u548C<code>expect</code>\u76F8\u7B49\uFF0C\u5C31\u8BC1\u660E\u6CA1\u6709\u5176\u4ED6\u7EBF\u7A0B\u6539\u53D8\u8FC7\u8FD9\u4E2A\u53D8\u91CF\uFF0C\u90A3\u4E48\u5C31\u66F4\u65B0\u5B83\u4E3A<code>update</code>\uFF0C\u5982\u679C\u4E0D\u76F8\u7B49\uFF0C\u90A3\u5C31\u4F1A\u7EE7\u7EED\u91CD\u8BD5\u76F4\u5230\u6210\u529F\u66F4\u65B0\u503C\u3002</p><h2 id="cas\u5B58\u5728\u7684\u95EE\u9898" tabindex="-1"><a class="header-anchor" href="#cas\u5B58\u5728\u7684\u95EE\u9898" aria-hidden="true">#</a> CAS\u5B58\u5728\u7684\u95EE\u9898\uFF1F</h2><p>CAS \u4E09\u5927\u95EE\u9898\uFF1A</p><ol><li><p><strong>ABA\u95EE\u9898</strong>\u3002CAS\u9700\u8981\u5728\u64CD\u4F5C\u503C\u7684\u65F6\u5019\u68C0\u67E5\u5185\u5B58\u503C\u662F\u5426\u53D1\u751F\u53D8\u5316\uFF0C\u6CA1\u6709\u53D1\u751F\u53D8\u5316\u624D\u4F1A\u66F4\u65B0\u5185\u5B58\u503C\u3002\u4F46\u662F\u5982\u679C\u5185\u5B58\u503C\u539F\u6765\u662FA\uFF0C\u540E\u6765\u53D8\u6210\u4E86B\uFF0C\u7136\u540E\u53C8\u53D8\u6210\u4E86A\uFF0C\u90A3\u4E48CAS\u8FDB\u884C\u68C0\u67E5\u65F6\u4F1A\u53D1\u73B0\u503C\u6CA1\u6709\u53D1\u751F\u53D8\u5316\uFF0C\u4F46\u662F\u5B9E\u9645\u4E0A\u662F\u6709\u53D8\u5316\u7684\u3002ABA\u95EE\u9898\u7684\u89E3\u51B3\u601D\u8DEF\u5C31\u662F\u5728\u53D8\u91CF\u524D\u9762\u6DFB\u52A0\u7248\u672C\u53F7\uFF0C\u6BCF\u6B21\u53D8\u91CF\u66F4\u65B0\u7684\u65F6\u5019\u90FD\u628A\u7248\u672C\u53F7\u52A0\u4E00\uFF0C\u8FD9\u6837\u53D8\u5316\u8FC7\u7A0B\u5C31\u4ECE<code>A\uFF0DB\uFF0DA</code>\u53D8\u6210\u4E86<code>1A\uFF0D2B\uFF0D3A</code>\u3002</p><p>JDK\u4ECE1.5\u5F00\u59CB\u63D0\u4F9B\u4E86AtomicStampedReference\u7C7B\u6765\u89E3\u51B3ABA\u95EE\u9898\uFF0C\u539F\u5B50\u66F4\u65B0\u5E26\u6709\u7248\u672C\u53F7\u7684\u5F15\u7528\u7C7B\u578B\u3002</p></li><li><p><strong>\u5FAA\u73AF\u65F6\u95F4\u957F\u5F00\u9500\u5927</strong>\u3002CAS\u64CD\u4F5C\u5982\u679C\u957F\u65F6\u95F4\u4E0D\u6210\u529F\uFF0C\u4F1A\u5BFC\u81F4\u5176\u4E00\u76F4\u81EA\u65CB\uFF0C\u7ED9CPU\u5E26\u6765\u975E\u5E38\u5927\u7684\u5F00\u9500\u3002</p></li><li><p><strong>\u53EA\u80FD\u4FDD\u8BC1\u4E00\u4E2A\u5171\u4EAB\u53D8\u91CF\u7684\u539F\u5B50\u64CD\u4F5C</strong>\u3002\u5BF9\u4E00\u4E2A\u5171\u4EAB\u53D8\u91CF\u6267\u884C\u64CD\u4F5C\u65F6\uFF0CCAS\u80FD\u591F\u4FDD\u8BC1\u539F\u5B50\u64CD\u4F5C\uFF0C\u4F46\u662F\u5BF9\u591A\u4E2A\u5171\u4EAB\u53D8\u91CF\u64CD\u4F5C\u65F6\uFF0CCAS\u662F\u65E0\u6CD5\u4FDD\u8BC1\u64CD\u4F5C\u7684\u539F\u5B50\u6027\u7684\u3002</p><p>Java\u4ECE1.5\u5F00\u59CBJDK\u63D0\u4F9B\u4E86AtomicReference\u7C7B\u6765\u4FDD\u8BC1\u5F15\u7528\u5BF9\u8C61\u4E4B\u95F4\u7684\u539F\u5B50\u6027\uFF0C\u53EF\u4EE5\u628A\u591A\u4E2A\u53D8\u91CF\u653E\u5728\u4E00\u4E2A\u5BF9\u8C61\u91CC\u6765\u8FDB\u884CCAS\u64CD\u4F5C\u3002</p></li></ol><h2 id="\u5E76\u53D1\u5DE5\u5177" tabindex="-1"><a class="header-anchor" href="#\u5E76\u53D1\u5DE5\u5177" aria-hidden="true">#</a> \u5E76\u53D1\u5DE5\u5177</h2><p>\u5728JDK\u7684\u5E76\u53D1\u5305\u91CC\u63D0\u4F9B\u4E86\u51E0\u4E2A\u975E\u5E38\u6709\u7528\u7684\u5E76\u53D1\u5DE5\u5177\u7C7B\u3002CountDownLatch\u3001CyclicBarrier\u548CSemaphore\u5DE5\u5177\u7C7B\u63D0\u4F9B\u4E86\u4E00\u79CD\u5E76\u53D1\u6D41\u7A0B\u63A7\u5236\u7684\u624B\u6BB5\u3002</p><h3 id="countdownlatch" tabindex="-1"><a class="header-anchor" href="#countdownlatch" aria-hidden="true">#</a> CountDownLatch</h3><p>CountDownLatch\u7528\u4E8E\u67D0\u4E2A\u7EBF\u7A0B\u7B49\u5F85\u5176\u4ED6\u7EBF\u7A0B<strong>\u6267\u884C\u5B8C\u4EFB\u52A1</strong>\u518D\u6267\u884C\uFF0C\u4E0Ethread.join()\u529F\u80FD\u7C7B\u4F3C\u3002\u5E38\u89C1\u7684\u5E94\u7528\u573A\u666F\u662F\u5F00\u542F\u591A\u4E2A\u7EBF\u7A0B\u540C\u65F6\u6267\u884C\u67D0\u4E2A\u4EFB\u52A1\uFF0C\u7B49\u5230\u6240\u6709\u4EFB\u52A1\u6267\u884C\u5B8C\u518D\u6267\u884C\u7279\u5B9A\u64CD\u4F5C\uFF0C\u5982\u6C47\u603B\u7EDF\u8BA1\u7ED3\u679C\u3002</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>public class CountDownLatchDemo {
    static final int N = 4;
    static CountDownLatch latch = new CountDownLatch(N);

    public static void main(String[] args) throws InterruptedException {

       for(int i = 0; i &lt; N; i++) {
            new Thread(new Thread1()).start();
       }

       latch.await(1000, TimeUnit.MILLISECONDS); //\u8C03\u7528await()\u65B9\u6CD5\u7684\u7EBF\u7A0B\u4F1A\u88AB\u6302\u8D77\uFF0C\u5B83\u4F1A\u7B49\u5F85\u76F4\u5230count\u503C\u4E3A0\u624D\u7EE7\u7EED\u6267\u884C;\u7B49\u5F85timeout\u65F6\u95F4\u540Ecount\u503C\u8FD8\u6CA1\u53D8\u4E3A0\u7684\u8BDD\u5C31\u4F1A\u7EE7\u7EED\u6267\u884C
       System.out.println(&quot;task finished&quot;);
    }

    static class Thread1 implements Runnable {

        @Override
        public void run() {
            try {
                System.out.println(Thread.currentThread().getName() + &quot;starts working&quot;);
                Thread.sleep(1000);
            } catch (InterruptedException e) {
                e.printStackTrace();
            } finally {
                latch.countDown();
            }
        }
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD0\u884C\u7ED3\u679C\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Thread</span><span class="token operator">-</span><span class="token number">0</span>starts working
<span class="token class-name">Thread</span><span class="token operator">-</span><span class="token number">1</span>starts working
<span class="token class-name">Thread</span><span class="token operator">-</span><span class="token number">2</span>starts working
<span class="token class-name">Thread</span><span class="token operator">-</span><span class="token number">3</span>starts working
task finished
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="cyclicbarrier" tabindex="-1"><a class="header-anchor" href="#cyclicbarrier" aria-hidden="true">#</a> CyclicBarrier</h3><p>CyclicBarrier(\u540C\u6B65\u5C4F\u969C)\uFF0C\u7528\u4E8E\u4E00\u7EC4\u7EBF\u7A0B\u4E92\u76F8\u7B49\u5F85\u5230\u67D0\u4E2A\u72B6\u6001\uFF0C\u7136\u540E\u8FD9\u7EC4\u7EBF\u7A0B\u518D<strong>\u540C\u65F6</strong>\u6267\u884C\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">CyclicBarrier</span><span class="token punctuation">(</span><span class="token keyword">int</span> parties<span class="token punctuation">,</span> <span class="token class-name">Runnable</span> barrierAction<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token class-name">CyclicBarrier</span><span class="token punctuation">(</span><span class="token keyword">int</span> parties<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u53C2\u6570parties\u6307\u8BA9\u591A\u5C11\u4E2A\u7EBF\u7A0B\u6216\u8005\u4EFB\u52A1\u7B49\u5F85\u81F3\u67D0\u4E2A\u72B6\u6001\uFF1B\u53C2\u6570barrierAction\u4E3A\u5F53\u8FD9\u4E9B\u7EBF\u7A0B\u90FD\u8FBE\u5230\u67D0\u4E2A\u72B6\u6001\u65F6\u4F1A\u6267\u884C\u7684\u5185\u5BB9\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CyclicBarrierTest</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u8BF7\u6C42\u7684\u6570\u91CF</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> threadCount <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token comment">// \u9700\u8981\u540C\u6B65\u7684\u7EBF\u7A0B\u6570\u91CF</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">CyclicBarrier</span> cyclicBarrier <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CyclicBarrier</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u521B\u5EFA\u7EBF\u7A0B\u6C60</span>
        <span class="token class-name">ExecutorService</span> threadPool <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> threadCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">final</span> <span class="token keyword">int</span> threadNum <span class="token operator">=</span> i<span class="token punctuation">;</span>
            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            threadPool<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token function">test</span><span class="token punctuation">(</span>threadNum<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment">// TODO Auto-generated catch block</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">BrokenBarrierException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment">// TODO Auto-generated catch block</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        threadPool<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token keyword">int</span> threadnum<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span><span class="token punctuation">,</span> <span class="token class-name">BrokenBarrierException</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;threadnum:&quot;</span> <span class="token operator">+</span> threadnum <span class="token operator">+</span> <span class="token string">&quot;is ready&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token doc-comment comment">/**\u7B49\u5F8560\u79D2\uFF0C\u4FDD\u8BC1\u5B50\u7EBF\u7A0B\u5B8C\u5168\u6267\u884C\u7ED3\u675F*/</span>
            cyclicBarrier<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;-----CyclicBarrierException------&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;threadnum:&quot;</span> <span class="token operator">+</span> threadnum <span class="token operator">+</span> <span class="token string">&quot;is finish&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD0\u884C\u7ED3\u679C\u5982\u4E0B\uFF0C\u53EF\u4EE5\u770B\u51FACyclicBarrier\u662F\u53EF\u4EE5\u91CD\u7528\u7684\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>threadnum<span class="token operator">:</span><span class="token number">0</span>is ready
threadnum<span class="token operator">:</span><span class="token number">1</span>is ready
threadnum<span class="token operator">:</span><span class="token number">2</span>is ready
threadnum<span class="token operator">:</span><span class="token number">3</span>is ready
threadnum<span class="token operator">:</span><span class="token number">4</span>is ready
threadnum<span class="token operator">:</span><span class="token number">4</span>is finish
threadnum<span class="token operator">:</span><span class="token number">3</span>is finish
threadnum<span class="token operator">:</span><span class="token number">2</span>is finish
threadnum<span class="token operator">:</span><span class="token number">1</span>is finish
threadnum<span class="token operator">:</span><span class="token number">0</span>is finish
threadnum<span class="token operator">:</span><span class="token number">5</span>is ready
threadnum<span class="token operator">:</span><span class="token number">6</span>is ready
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5F53\u56DB\u4E2A\u7EBF\u7A0B\u90FD\u5230\u8FBEbarrier\u72B6\u6001\u540E\uFF0C\u4F1A\u4ECE\u56DB\u4E2A\u7EBF\u7A0B\u4E2D\u9009\u62E9\u4E00\u4E2A\u7EBF\u7A0B\u53BB\u6267\u884CRunnable\u3002</p><h3 id="cyclicbarrier\u548Ccountdownlatch\u533A\u522B" tabindex="-1"><a class="header-anchor" href="#cyclicbarrier\u548Ccountdownlatch\u533A\u522B" aria-hidden="true">#</a> CyclicBarrier\u548CCountDownLatch\u533A\u522B</h3><p>CyclicBarrier \u548C CountDownLatch \u90FD\u80FD\u591F\u5B9E\u73B0\u7EBF\u7A0B\u4E4B\u95F4\u7684\u7B49\u5F85\u3002</p><p>CountDownLatch\u7528\u4E8E\u67D0\u4E2A\u7EBF\u7A0B\u7B49\u5F85\u5176\u4ED6\u7EBF\u7A0B<strong>\u6267\u884C\u5B8C\u4EFB\u52A1</strong>\u518D\u6267\u884C\u3002CyclicBarrier\u7528\u4E8E\u4E00\u7EC4\u7EBF\u7A0B\u4E92\u76F8\u7B49\u5F85\u5230\u67D0\u4E2A\u72B6\u6001\uFF0C\u7136\u540E\u8FD9\u7EC4\u7EBF\u7A0B\u518D<strong>\u540C\u65F6</strong>\u6267\u884C\u3002 CountDownLatch\u7684\u8BA1\u6570\u5668\u53EA\u80FD\u4F7F\u7528\u4E00\u6B21\uFF0C\u800CCyclicBarrier\u7684\u8BA1\u6570\u5668\u53EF\u4EE5\u4F7F\u7528reset()\u65B9\u6CD5\u91CD\u7F6E\uFF0C\u53EF\u7528\u4E8E\u5904\u7406\u66F4\u4E3A\u590D\u6742\u7684\u4E1A\u52A1\u573A\u666F\u3002</p><h3 id="semaphore" tabindex="-1"><a class="header-anchor" href="#semaphore" aria-hidden="true">#</a> Semaphore</h3><p>Semaphore\u7C7B\u4F3C\u4E8E\u9501\uFF0C\u5B83\u7528\u4E8E\u63A7\u5236\u540C\u65F6\u8BBF\u95EE\u7279\u5B9A\u8D44\u6E90\u7684\u7EBF\u7A0B\u6570\u91CF\uFF0C\u63A7\u5236\u5E76\u53D1\u7EBF\u7A0B\u6570\u3002</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>public class SemaphoreDemo {
    public static void main(String[] args) {
        final int N = 7;
        Semaphore s = new Semaphore(3);
        for(int i = 0; i &lt; N; i++) {
            new Worker(s, i).start();
        }
    }

    static class Worker extends Thread {
        private Semaphore s;
        private int num;
        public Worker(Semaphore s, int num) {
            this.s = s;
            this.num = num;
        }

        @Override
        public void run() {
            try {
                s.acquire();
                System.out.println(&quot;worker&quot; + num +  &quot; using the machine&quot;);
                Thread.sleep(1000);
                System.out.println(&quot;worker&quot; + num +  &quot; finished the task&quot;);
                s.release();
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD0\u884C\u7ED3\u679C\u5982\u4E0B\uFF0C\u53EF\u4EE5\u770B\u51FA\u5E76\u975E\u6309\u7167\u7EBF\u7A0B\u8BBF\u95EE\u987A\u5E8F\u83B7\u53D6\u8D44\u6E90\u7684\u9501\uFF0C\u5373</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>worker0 using the machine
worker1 using the machine
worker2 using the machine
worker2 finished the task
worker0 finished the task
worker3 using the machine
worker4 using the machine
worker1 finished the task
worker6 using the machine
worker4 finished the task
worker3 finished the task
worker6 finished the task
worker5 using the machine
worker5 finished the task
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u539F\u5B50\u7C7B" tabindex="-1"><a class="header-anchor" href="#\u539F\u5B50\u7C7B" aria-hidden="true">#</a> \u539F\u5B50\u7C7B</h2><h3 id="\u57FA\u672C\u7C7B\u578B\u539F\u5B50\u7C7B" tabindex="-1"><a class="header-anchor" href="#\u57FA\u672C\u7C7B\u578B\u539F\u5B50\u7C7B" aria-hidden="true">#</a> \u57FA\u672C\u7C7B\u578B\u539F\u5B50\u7C7B</h3><p>\u4F7F\u7528\u539F\u5B50\u7684\u65B9\u5F0F\u66F4\u65B0\u57FA\u672C\u7C7B\u578B</p><ul><li>AtomicInteger\uFF1A\u6574\u578B\u539F\u5B50\u7C7B</li><li>AtomicLong\uFF1A\u957F\u6574\u578B\u539F\u5B50\u7C7B</li><li>AtomicBoolean \uFF1A\u5E03\u5C14\u578B\u539F\u5B50\u7C7B</li></ul><p>AtomicInteger \u7C7B\u5E38\u7528\u7684\u65B9\u6CD5\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//\u83B7\u53D6\u5F53\u524D\u7684\u503C</span>
<span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">getAndSet</span><span class="token punctuation">(</span><span class="token keyword">int</span> newValue<span class="token punctuation">)</span><span class="token comment">//\u83B7\u53D6\u5F53\u524D\u7684\u503C\uFF0C\u5E76\u8BBE\u7F6E\u65B0\u7684\u503C</span>
<span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">getAndIncrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//\u83B7\u53D6\u5F53\u524D\u7684\u503C\uFF0C\u5E76\u81EA\u589E</span>
<span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">getAndDecrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//\u83B7\u53D6\u5F53\u524D\u7684\u503C\uFF0C\u5E76\u81EA\u51CF</span>
<span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">getAndAdd</span><span class="token punctuation">(</span><span class="token keyword">int</span> delta<span class="token punctuation">)</span> <span class="token comment">//\u83B7\u53D6\u5F53\u524D\u7684\u503C\uFF0C\u5E76\u52A0\u4E0A\u9884\u671F\u7684\u503C</span>
<span class="token keyword">boolean</span> <span class="token function">compareAndSet</span><span class="token punctuation">(</span><span class="token keyword">int</span> expect<span class="token punctuation">,</span> <span class="token keyword">int</span> update<span class="token punctuation">)</span> <span class="token comment">//\u5982\u679C\u8F93\u5165\u7684\u6570\u503C\u7B49\u4E8E\u9884\u671F\u503C\uFF0C\u5219\u4EE5\u539F\u5B50\u65B9\u5F0F\u5C06\u8BE5\u503C\u8BBE\u7F6E\u4E3A\u8F93\u5165\u503C\uFF08update\uFF09</span>
<span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">lazySet</span><span class="token punctuation">(</span><span class="token keyword">int</span> newValue<span class="token punctuation">)</span><span class="token comment">//\u6700\u7EC8\u8BBE\u7F6E\u4E3AnewValue,\u4F7F\u7528 lazySet \u8BBE\u7F6E\u4E4B\u540E\u53EF\u80FD\u5BFC\u81F4\u5176\u4ED6\u7EBF\u7A0B\u5728\u4E4B\u540E\u7684\u4E00\u5C0F\u6BB5\u65F6\u95F4\u5185\u8FD8\u662F\u53EF\u4EE5\u8BFB\u5230\u65E7\u7684\u503C\u3002</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>AtomicInteger \u7C7B\u4E3B\u8981\u5229\u7528 CAS (compare and swap) \u4FDD\u8BC1\u539F\u5B50\u64CD\u4F5C\uFF0C\u4ECE\u800C\u907F\u514D\u52A0\u9501\u7684\u9AD8\u5F00\u9500\u3002</p><h3 id="\u6570\u7EC4\u7C7B\u578B\u539F\u5B50\u7C7B" tabindex="-1"><a class="header-anchor" href="#\u6570\u7EC4\u7C7B\u578B\u539F\u5B50\u7C7B" aria-hidden="true">#</a> \u6570\u7EC4\u7C7B\u578B\u539F\u5B50\u7C7B</h3><p>\u4F7F\u7528\u539F\u5B50\u7684\u65B9\u5F0F\u66F4\u65B0\u6570\u7EC4\u91CC\u7684\u67D0\u4E2A\u5143\u7D20</p><ul><li>AtomicIntegerArray\uFF1A\u6574\u5F62\u6570\u7EC4\u539F\u5B50\u7C7B</li><li>AtomicLongArray\uFF1A\u957F\u6574\u5F62\u6570\u7EC4\u539F\u5B50\u7C7B</li><li>AtomicReferenceArray \uFF1A\u5F15\u7528\u7C7B\u578B\u6570\u7EC4\u539F\u5B50\u7C7B</li></ul><p>AtomicIntegerArray \u7C7B\u5E38\u7528\u65B9\u6CD5\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token comment">//\u83B7\u53D6 index=i \u4F4D\u7F6E\u5143\u7D20\u7684\u503C</span>
<span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">getAndSet</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> newValue<span class="token punctuation">)</span><span class="token comment">//\u8FD4\u56DE index=i \u4F4D\u7F6E\u7684\u5F53\u524D\u7684\u503C\uFF0C\u5E76\u5C06\u5176\u8BBE\u7F6E\u4E3A\u65B0\u503C\uFF1AnewValue</span>
<span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">getAndIncrement</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span><span class="token comment">//\u83B7\u53D6 index=i \u4F4D\u7F6E\u5143\u7D20\u7684\u503C\uFF0C\u5E76\u8BA9\u8BE5\u4F4D\u7F6E\u7684\u5143\u7D20\u81EA\u589E</span>
<span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">getAndDecrement</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token comment">//\u83B7\u53D6 index=i \u4F4D\u7F6E\u5143\u7D20\u7684\u503C\uFF0C\u5E76\u8BA9\u8BE5\u4F4D\u7F6E\u7684\u5143\u7D20\u81EA\u51CF</span>
<span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">getAndAdd</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> delta<span class="token punctuation">)</span> <span class="token comment">//\u83B7\u53D6 index=i \u4F4D\u7F6E\u5143\u7D20\u7684\u503C\uFF0C\u5E76\u52A0\u4E0A\u9884\u671F\u7684\u503C</span>
<span class="token keyword">boolean</span> <span class="token function">compareAndSet</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> expect<span class="token punctuation">,</span> <span class="token keyword">int</span> update<span class="token punctuation">)</span> <span class="token comment">//\u5982\u679C\u8F93\u5165\u7684\u6570\u503C\u7B49\u4E8E\u9884\u671F\u503C\uFF0C\u5219\u4EE5\u539F\u5B50\u65B9\u5F0F\u5C06 index=i \u4F4D\u7F6E\u7684\u5143\u7D20\u503C\u8BBE\u7F6E\u4E3A\u8F93\u5165\u503C\uFF08update\uFF09</span>
<span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">lazySet</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> newValue<span class="token punctuation">)</span><span class="token comment">//\u6700\u7EC8 \u5C06index=i \u4F4D\u7F6E\u7684\u5143\u7D20\u8BBE\u7F6E\u4E3AnewValue,\u4F7F\u7528 lazySet \u8BBE\u7F6E\u4E4B\u540E\u53EF\u80FD\u5BFC\u81F4\u5176\u4ED6\u7EBF\u7A0B\u5728\u4E4B\u540E\u7684\u4E00\u5C0F\u6BB5\u65F6\u95F4\u5185\u8FD8\u662F\u53EF\u4EE5\u8BFB\u5230\u65E7\u7684\u503C\u3002</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u5F15\u7528\u7C7B\u578B\u539F\u5B50\u7C7B" tabindex="-1"><a class="header-anchor" href="#\u5F15\u7528\u7C7B\u578B\u539F\u5B50\u7C7B" aria-hidden="true">#</a> \u5F15\u7528\u7C7B\u578B\u539F\u5B50\u7C7B</h3><ul><li>AtomicReference\uFF1A\u5F15\u7528\u7C7B\u578B\u539F\u5B50\u7C7B</li><li>AtomicStampedReference\uFF1A\u5E26\u6709\u7248\u672C\u53F7\u7684\u5F15\u7528\u7C7B\u578B\u539F\u5B50\u7C7B\u3002\u8BE5\u7C7B\u5C06\u6574\u6570\u503C\u4E0E\u5F15\u7528\u5173\u8054\u8D77\u6765\uFF0C\u53EF\u7528\u4E8E\u89E3\u51B3\u539F\u5B50\u7684\u66F4\u65B0\u6570\u636E\u548C\u6570\u636E\u7684\u7248\u672C\u53F7\uFF0C\u53EF\u4EE5\u89E3\u51B3\u4F7F\u7528 CAS \u8FDB\u884C\u539F\u5B50\u66F4\u65B0\u65F6\u53EF\u80FD\u51FA\u73B0\u7684 ABA \u95EE\u9898\u3002</li><li>AtomicMarkableReference \uFF1A\u539F\u5B50\u66F4\u65B0\u5E26\u6709\u6807\u8BB0\u7684\u5F15\u7528\u7C7B\u578B\u3002\u8BE5\u7C7B\u5C06 boolean \u6807\u8BB0\u4E0E\u5F15\u7528\u5173\u8054\u8D77\u6765</li></ul><h2 id="\u4E3A\u4EC0\u4E48\u8981\u4F7F\u7528executor\u7EBF\u7A0B\u6C60\u6846\u67B6\u5462" tabindex="-1"><a class="header-anchor" href="#\u4E3A\u4EC0\u4E48\u8981\u4F7F\u7528executor\u7EBF\u7A0B\u6C60\u6846\u67B6\u5462" aria-hidden="true">#</a> \u4E3A\u4EC0\u4E48\u8981\u4F7F\u7528Executor\u7EBF\u7A0B\u6C60\u6846\u67B6\u5462\uFF1F</h2><ul><li>\u6BCF\u6B21\u6267\u884C\u4EFB\u52A1\u90FD\u901A\u8FC7new Thread()\u53BB\u521B\u5EFA\u7EBF\u7A0B\uFF0C\u6BD4\u8F83\u6D88\u8017\u6027\u80FD\uFF0C\u521B\u5EFA\u4E00\u4E2A\u7EBF\u7A0B\u662F\u6BD4\u8F83\u8017\u65F6\u3001\u8017\u8D44\u6E90\u7684</li><li>\u8C03\u7528new Thread()\u521B\u5EFA\u7684\u7EBF\u7A0B\u7F3A\u4E4F\u7BA1\u7406\uFF0C\u53EF\u4EE5\u65E0\u9650\u5236\u7684\u521B\u5EFA\uFF0C\u7EBF\u7A0B\u4E4B\u95F4\u7684\u76F8\u4E92\u7ADE\u4E89\u4F1A\u5BFC\u81F4\u8FC7\u591A\u5360\u7528\u7CFB\u7EDF\u8D44\u6E90\u800C\u5BFC\u81F4\u7CFB\u7EDF\u762B\u75EA</li><li>\u76F4\u63A5\u4F7F\u7528new Thread()\u542F\u52A8\u7684\u7EBF\u7A0B\u4E0D\u5229\u4E8E\u6269\u5C55\uFF0C\u6BD4\u5982\u5B9A\u65F6\u6267\u884C\u3001\u5B9A\u671F\u6267\u884C\u3001\u5B9A\u65F6\u5B9A\u671F\u6267\u884C\u3001\u7EBF\u7A0B\u4E2D\u65AD\u7B49\u90FD\u4E0D\u597D\u5B9E\u73B0</li></ul><h2 id="\u5982\u4F55\u505C\u6B62\u4E00\u4E2A\u6B63\u5728\u8FD0\u884C\u7684\u7EBF\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u5982\u4F55\u505C\u6B62\u4E00\u4E2A\u6B63\u5728\u8FD0\u884C\u7684\u7EBF\u7A0B" aria-hidden="true">#</a> \u5982\u4F55\u505C\u6B62\u4E00\u4E2A\u6B63\u5728\u8FD0\u884C\u7684\u7EBF\u7A0B\uFF1F</h2><ol><li>\u4F7F\u7528\u5171\u4EAB\u53D8\u91CF\u7684\u65B9\u5F0F\u3002\u5171\u4EAB\u53D8\u91CF\u53EF\u4EE5\u88AB\u591A\u4E2A\u6267\u884C\u76F8\u540C\u4EFB\u52A1\u7684\u7EBF\u7A0B\u7528\u6765\u4F5C\u4E3A\u662F\u5426\u505C\u6B62\u7684\u4FE1\u53F7\uFF0C\u901A\u77E5\u505C\u6B62\u7EBF\u7A0B\u7684\u6267\u884C\u3002</li><li>\u4F7F\u7528interrupt\u65B9\u6CD5\u7EC8\u6B62\u7EBF\u7A0B\u3002\u5F53\u4E00\u4E2A\u7EBF\u7A0B\u88AB\u963B\u585E\uFF0C\u5904\u4E8E\u4E0D\u53EF\u8FD0\u884C\u72B6\u6001\u65F6\uFF0C\u5373\u4F7F\u4E3B\u7A0B\u5E8F\u4E2D\u5C06\u8BE5\u7EBF\u7A0B\u7684\u5171\u4EAB\u53D8\u91CF\u8BBE\u7F6E\u4E3Atrue\uFF0C\u4F46\u8BE5\u7EBF\u7A0B\u6B64\u65F6\u6839\u672C\u65E0\u6CD5\u68C0\u67E5\u5FAA\u73AF\u6807\u5FD7\uFF0C\u5F53\u7136\u4E5F\u5C31\u65E0\u6CD5\u7ACB\u5373\u4E2D\u65AD\u3002\u8FD9\u65F6\u5019\u53EF\u4EE5\u4F7F\u7528Thread\u63D0\u4F9B\u7684interrupt()\u65B9\u6CD5\uFF0C\u56E0\u4E3A\u8BE5\u65B9\u6CD5\u867D\u7136\u4E0D\u4F1A\u4E2D\u65AD\u4E00\u4E2A\u6B63\u5728\u8FD0\u884C\u7684\u7EBF\u7A0B\uFF0C\u4F46\u662F\u5B83\u53EF\u4EE5\u4F7F\u4E00\u4E2A\u88AB\u963B\u585E\u7684\u7EBF\u7A0B\u629B\u51FA\u4E00\u4E2A\u4E2D\u65AD\u5F02\u5E38\uFF0C\u4ECE\u800C\u4F7F\u7EBF\u7A0B\u63D0\u524D\u7ED3\u675F\u963B\u585E\u72B6\u6001\u3002</li></ol><h2 id="\u4EC0\u4E48\u662Fdaemon\u7EBF\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u4EC0\u4E48\u662Fdaemon\u7EBF\u7A0B" aria-hidden="true">#</a> \u4EC0\u4E48\u662FDaemon\u7EBF\u7A0B\uFF1F</h2><p>\u540E\u53F0(daemon)\u7EBF\u7A0B\uFF0C\u662F\u6307\u5728\u7A0B\u5E8F\u8FD0\u884C\u7684\u65F6\u5019\u5728\u540E\u53F0\u63D0\u4F9B\u4E00\u79CD\u901A\u7528\u670D\u52A1\u7684\u7EBF\u7A0B\uFF0C\u5E76\u4E14\u8FD9\u4E2A\u7EBF\u7A0B\u5E76\u4E0D\u5C5E\u4E8E\u7A0B\u5E8F\u4E2D\u4E0D\u53EF\u6216\u7F3A\u7684\u90E8\u5206\u3002\u56E0\u6B64\uFF0C\u5F53\u6240\u6709\u7684\u975E\u540E\u53F0\u7EBF\u7A0B\u7ED3\u675F\u65F6\uFF0C\u7A0B\u5E8F\u4E5F\u5C31\u7EC8\u6B62\u4E86\uFF0C\u540C\u65F6\u4F1A\u6740\u6B7B\u8FDB\u7A0B\u4E2D\u7684\u6240\u6709\u540E\u53F0\u7EBF\u7A0B\u3002\u53CD\u8FC7\u6765\u8BF4\uFF0C\u53EA\u8981\u6709\u4EFB\u4F55\u975E\u540E\u53F0\u7EBF\u7A0B\u8FD8\u5728\u8FD0\u884C\uFF0C\u7A0B\u5E8F\u5C31\u4E0D\u4F1A\u7EC8\u6B62\u3002\u5FC5\u987B\u5728\u7EBF\u7A0B\u542F\u52A8\u4E4B\u524D\u8C03\u7528setDaemon()\u65B9\u6CD5\uFF0C\u624D\u80FD\u628A\u5B83\u8BBE\u7F6E\u4E3A\u540E\u53F0\u7EBF\u7A0B\u3002</p><p>\u6CE8\u610F\uFF1A\u540E\u53F0\u8FDB\u7A0B\u5728\u4E0D\u6267\u884Cfinally\u5B50\u53E5\u7684\u60C5\u51B5\u4E0B\u5C31\u4F1A\u7EC8\u6B62\u5176run()\u65B9\u6CD5\u3002</p><p>\u6BD4\u5982\uFF1AJVM\u7684\u5783\u573E\u56DE\u6536\u7EBF\u7A0B\u5C31\u662FDaemon\u7EBF\u7A0B\uFF0CFinalizer\u4E5F\u662F\u5B88\u62A4\u7EBF\u7A0B\u3002</p><h2 id="synchronizedmap\u548Cconcurrenthashmap\u6709\u4EC0\u4E48\u533A\u522B" tabindex="-1"><a class="header-anchor" href="#synchronizedmap\u548Cconcurrenthashmap\u6709\u4EC0\u4E48\u533A\u522B" aria-hidden="true">#</a> SynchronizedMap\u548CConcurrentHashMap\u6709\u4EC0\u4E48\u533A\u522B\uFF1F</h2><p>SynchronizedMap\u4E00\u6B21\u9501\u4F4F\u6574\u5F20\u8868\u6765\u4FDD\u8BC1\u7EBF\u7A0B\u5B89\u5168\uFF0C\u6240\u4EE5\u6BCF\u6B21\u53EA\u80FD\u6709\u4E00\u4E2A\u7EBF\u7A0B\u6765\u8BBF\u95EEmap\u3002</p><p>JDK1.8 ConcurrentHashMap\u91C7\u7528CAS\u548Csynchronized\u6765\u4FDD\u8BC1\u5E76\u53D1\u5B89\u5168\u3002\u6570\u636E\u7ED3\u6784\u91C7\u7528\u6570\u7EC4+\u94FE\u8868/\u7EA2\u9ED1\u4E8C\u53C9\u6811\u3002synchronized\u53EA\u9501\u5B9A\u5F53\u524D\u94FE\u8868\u6216\u7EA2\u9ED1\u4E8C\u53C9\u6811\u7684\u9996\u8282\u70B9\uFF0C\u652F\u6301\u5E76\u53D1\u8BBF\u95EE\u3001\u4FEE\u6539\u3002 \u53E6\u5916ConcurrentHashMap\u4F7F\u7528\u4E86\u4E00\u79CD\u4E0D\u540C\u7684\u8FED\u4EE3\u65B9\u5F0F\u3002\u5F53iterator\u88AB\u521B\u5EFA\u540E\u96C6\u5408\u518D\u53D1\u751F\u6539\u53D8\u5C31\u4E0D\u518D\u662F\u629B\u51FAConcurrentModificationException\uFF0C\u53D6\u800C\u4EE3\u4E4B\u7684\u662F\u5728\u6539\u53D8\u65F6new\u65B0\u7684\u6570\u636E\u4ECE\u800C\u4E0D\u5F71\u54CD\u539F\u6709\u7684\u6570\u636E \uFF0Citerator\u5B8C\u6210\u540E\u518D\u5C06\u5934\u6307\u9488\u66FF\u6362\u4E3A\u65B0\u7684\u6570\u636E \uFF0C\u8FD9\u6837iterator\u7EBF\u7A0B\u53EF\u4EE5\u4F7F\u7528\u539F\u6765\u8001\u7684\u6570\u636E\uFF0C\u800C\u5199\u7EBF\u7A0B\u4E5F\u53EF\u4EE5\u5E76\u53D1\u7684\u5B8C\u6210\u6539\u53D8\u3002</p><h2 id="\u600E\u4E48\u5224\u65AD\u7EBF\u7A0B\u6C60\u7684\u4EFB\u52A1\u662F\u4E0D\u662F\u6267\u884C\u5B8C\u4E86" tabindex="-1"><a class="header-anchor" href="#\u600E\u4E48\u5224\u65AD\u7EBF\u7A0B\u6C60\u7684\u4EFB\u52A1\u662F\u4E0D\u662F\u6267\u884C\u5B8C\u4E86" aria-hidden="true">#</a> \u600E\u4E48\u5224\u65AD\u7EBF\u7A0B\u6C60\u7684\u4EFB\u52A1\u662F\u4E0D\u662F\u6267\u884C\u5B8C\u4E86\uFF1F</h2><p>\u6709\u51E0\u79CD\u65B9\u6CD5\uFF1A</p><p>1\u3001\u4F7F\u7528\u7EBF\u7A0B\u6C60\u7684\u539F\u751F\u51FD\u6570<strong>isTerminated()</strong>;</p><p>executor\u63D0\u4F9B\u4E00\u4E2A\u539F\u751F\u51FD\u6570isTerminated()\u6765\u5224\u65AD\u7EBF\u7A0B\u6C60\u4E2D\u7684\u4EFB\u52A1\u662F\u5426\u5168\u90E8\u5B8C\u6210\u3002\u5982\u679C\u5168\u90E8\u5B8C\u6210\u8FD4\u56DEtrue\uFF0C\u5426\u5219\u8FD4\u56DEfalse\u3002</p><p>2\u3001<strong>\u4F7F\u7528\u91CD\u5165\u9501\uFF0C\u7EF4\u6301\u4E00\u4E2A\u516C\u5171\u8BA1\u6570</strong>\u3002</p><p>\u6240\u6709\u7684\u666E\u901A\u4EFB\u52A1\u7EF4\u6301\u4E00\u4E2A\u8BA1\u6570\u5668\uFF0C\u5F53\u4EFB\u52A1\u5B8C\u6210\u65F6\u8BA1\u6570\u5668\u52A0\u4E00\uFF08\u8FD9\u91CC\u8981\u52A0\u9501\uFF09\uFF0C\u5F53\u8BA1\u6570\u5668\u7684\u503C\u7B49\u4E8E\u4EFB\u52A1\u6570\u65F6\uFF0C\u8FD9\u65F6\u6240\u6709\u7684\u4EFB\u52A1\u5DF2\u7ECF\u6267\u884C\u5B8C\u6BD5\u4E86\u3002</p><p>3\u3001<strong>\u4F7F\u7528CountDownLatch</strong>\u3002</p><p>\u5B83\u7684\u539F\u7406\u8DDF\u7B2C\u4E8C\u79CD\u65B9\u6CD5\u7C7B\u4F3C\uFF0C\u7ED9CountDownLatch\u4E00\u4E2A\u8BA1\u6570\u503C\uFF0C\u4EFB\u52A1\u6267\u884C\u5B8C\u6BD5\u540E\uFF0C\u8C03\u7528countDown()\u6267\u884C\u8BA1\u6570\u503C\u51CF\u4E00\u3002\u6700\u540E\u6267\u884C\u7684\u4EFB\u52A1\u5728\u8C03\u7528\u65B9\u6CD5\u7684\u5F00\u59CB\u8C03\u7528await()\u65B9\u6CD5\uFF0C\u8FD9\u6837\u6574\u4E2A\u4EFB\u52A1\u4F1A\u963B\u585E\uFF0C\u76F4\u5230\u8FD9\u4E2A\u8BA1\u6570\u503C\u4E3A\u96F6\uFF0C\u624D\u4F1A\u7EE7\u7EED\u6267\u884C\u3002</p><p>\u8FD9\u79CD\u65B9\u5F0F\u7684<strong>\u7F3A\u70B9</strong>\u5C31\u662F\u9700\u8981\u63D0\u524D\u77E5\u9053\u4EFB\u52A1\u7684\u6570\u91CF\u3002</p><p>4\u3001<strong>submit\u5411\u7EBF\u7A0B\u6C60\u63D0\u4EA4\u4EFB\u52A1\uFF0C\u4F7F\u7528Future\u5224\u65AD\u4EFB\u52A1\u6267\u884C\u72B6\u6001</strong>\u3002</p><p>\u4F7F\u7528submit\u5411\u7EBF\u7A0B\u6C60\u63D0\u4EA4\u4EFB\u52A1\u4E0Eexecute\u63D0\u4EA4\u4E0D\u540C\uFF0Csubmit\u4F1A\u6709Future\u7C7B\u578B\u7684\u8FD4\u56DE\u503C\u3002\u901A\u8FC7future.isDone()\u65B9\u6CD5\u53EF\u4EE5\u77E5\u9053\u4EFB\u52A1\u662F\u5426\u6267\u884C\u5B8C\u6210\u3002</p><p><img src="http://img.dabin-coder.cn/image/20220612101342.png" alt="" loading="lazy"></p>`,293),c=[p];function o(i,l){return s(),a("div",null,c)}var d=n(t,[["render",o],["__file","java-concurrent.html.vue"]]);export{d as default};
